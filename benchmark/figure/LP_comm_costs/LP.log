2025-05-14 20:19:37,088	INFO dashboard_sdk.py:338 -- Uploading package gcs://_ray_pkg_f82b624e2786f519.zip.
2025-05-14 20:19:37,088	INFO packaging.py:575 -- Creating a file package for local module '.'.
Job submission server address: http://localhost:8265

-------------------------------------------------------
Job 'raysubmit_yCtxyg6vweiW3NeF' submitted successfully
-------------------------------------------------------

Next steps
  Query the logs of the job:
    ray job logs raysubmit_yCtxyg6vweiW3NeF
  Query the status of the job:
    ray job status raysubmit_yCtxyg6vweiW3NeF
  Request the job to be stopped:
    ray job stop raysubmit_yCtxyg6vweiW3NeF

Tailing logs until the job exits (disable with --no-wait):

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: 4D-FED-GNN+, Countries: US
--------------------------------------------------------------------------------

2025-05-15 00:19:52,506	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:19:52,506	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:19:52,518	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
data/LPDataset not exists, creating directory
Downloading traveled_users from https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p...
Downloading...
From: https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/traveled_users.txt

  0%|          | 0.00/552k [00:00<?, ?B/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552k/552k [00:00<00:00, 13.7MB/s]
Downloaded traveled_users to data/LPDataset/traveled_users.txt
Downloading data_global from https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J...
Downloading...
From (original): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J
From (redirected): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J&confirm=t&uuid=fff0d6a1-5bed-407e-ab41-015321599435
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_global.txt

  0%|          | 0.00/278M [00:00<?, ?B/s]
  3%|â–Ž         | 9.44M/278M [00:00<00:02, 93.4MB/s]
  8%|â–Š         | 21.5M/278M [00:00<00:02, 101MB/s] 
 17%|â–ˆâ–‹        | 47.2M/278M [00:00<00:01, 169MB/s]
 25%|â–ˆâ–ˆâ–Œ       | 69.7M/278M [00:00<00:01, 189MB/s]
 32%|â–ˆâ–ˆâ–ˆâ–      | 89.1M/278M [00:00<00:01, 154MB/s]
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 106M/278M [00:00<00:01, 134MB/s] 
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 121M/278M [00:00<00:01, 128MB/s]
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 146M/278M [00:00<00:00, 161MB/s]
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 170M/278M [00:01<00:00, 182MB/s]
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 190M/278M [00:01<00:00, 158MB/s]
 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 214M/278M [00:01<00:00, 179MB/s]
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 234M/278M [00:01<00:00, 154MB/s]
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 251M/278M [00:01<00:00, 152MB/s]
 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 274M/278M [00:01<00:00, 172MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 278M/278M [00:01<00:00, 159MB/s]
Downloaded data_global to data/LPDataset/data_global.txt
Downloading data_US from https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd...
Downloading...
From (original): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd
From (redirected): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd&confirm=t&uuid=337797b4-b32a-4d24-821a-125656657b58
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_US.txt

  0%|          | 0.00/118M [00:00<?, ?B/s]
  4%|â–         | 4.72M/118M [00:00<00:02, 45.9MB/s]
 21%|â–ˆâ–ˆ        | 24.6M/118M [00:00<00:00, 135MB/s] 
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 46.1M/118M [00:00<00:00, 168MB/s]
 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 63.4M/118M [00:00<00:00, 157MB/s]
 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 85.5M/118M [00:00<00:00, 177MB/s]
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 105M/118M [00:00<00:00, 183MB/s] 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 118M/118M [00:00<00:00, 172MB/s]
Downloaded data_US to data/LPDataset/data_US.txt
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 27791.664 ms //end
//Log Large1 init network: 353443.0 //end
//Log Large2 init network: 400745.0 //end
//Log Large3 init network: 318060.0 //end
//Log Large4 init network: 353542.0 //end
//Log Server init network: 1784085.0 //end
//Log Initialization Communication Cost (MB): 3.06 //end
Pretrain start time recorded.
//pretrain_time: 587.481 ms//end
[36m(Trainer pid=68093, ip=192.168.14.54)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=68093, ip=192.168.14.54)[0m data/LPDataset not exists, creating directory
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloading traveled_users from https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p...
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloading...
[36m(Trainer pid=68093, ip=192.168.14.54)[0m From: https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p
[36m(Trainer pid=68093, ip=192.168.14.54)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/traveled_users.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
  0%|          | 0.00/552k [00:00<?, ?B/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552k/552k [00:00<00:00, 13.1MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloaded traveled_users to data/LPDataset/traveled_users.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloading data_global from https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J...
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloading...
[36m(Trainer pid=68093, ip=192.168.14.54)[0m From (original): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J
[36m(Trainer pid=68093, ip=192.168.14.54)[0m From (redirected): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J&confirm=t&uuid=4b96146c-eb4e-4ff8-9993-5c585cbb967f
[36m(Trainer pid=68093, ip=192.168.14.54)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_global.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
  0%|          | 0.00/278M [00:00<?, ?B/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
  4%|â–         | 10.5M/278M [00:00<00:02, 103MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 13%|â–ˆâ–Ž        | 35.1M/278M [00:00<00:01, 186MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 21%|â–ˆâ–ˆ        | 57.1M/278M [00:00<00:01, 200MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 29%|â–ˆâ–ˆâ–‰       | 81.3M/278M [00:00<00:00, 215MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 105M/278M [00:00<00:00, 224MB/s] 
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 130M/278M [00:00<00:00, 230MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 153M/278M [00:00<00:00, 179MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 178M/278M [00:00<00:00, 197MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 202M/278M [00:00<00:00, 209MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 228M/278M [00:01<00:00, 222MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 253M/278M [00:01<00:00, 227MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloaded data_global to data/LPDataset/data_global.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloading data_US from https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd...
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 276M/278M [00:01<00:00, 230MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 278M/278M [00:01<00:00, 212MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloading...
[36m(Trainer pid=68093, ip=192.168.14.54)[0m From (original): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd
[36m(Trainer pid=68093, ip=192.168.14.54)[0m From (redirected): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd&confirm=t&uuid=4be7f7c7-348a-41d4-8f69-4dcec73c93e0
[36m(Trainer pid=68093, ip=192.168.14.54)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_US.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
  0%|          | 0.00/118M [00:00<?, ?B/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
  2%|â–         | 2.62M/118M [00:00<00:04, 25.8MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 20%|â–ˆâ–‰        | 23.6M/118M [00:00<00:00, 128MB/s] 
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 46.1M/118M [00:00<00:00, 170MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 63.4M/118M [00:00<00:00, 111MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 83.4M/118M [00:00<00:00, 134MB/s]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105M/118M [00:00<00:00, 155MB/s] 
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Downloaded data_US to data/LPDataset/data_US.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=68093, ip=192.168.14.54)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 118M/118M [00:00<00:00, 133MB/s]
//Log Max memory for Large1: 5409419264.0 //end
//Log Max memory for Large2: 4796280832.0 //end
//Log Max memory for Large3: 4782428160.0 //end
//Log Max memory for Large4: 5083521024.0 //end
//Log Max memory for Server: 18058477568.0 //end
//Log Large1 network: 153958798.0 //end
//Log Large2 network: 384883.0 //end
//Log Large3 network: 351635.0 //end
//Log Large4 network: 357588.0 //end
//Log Server network: 31851062.0 //end
//Log Total Actual Pretrain Comm Cost: 178.25 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Device: 'cpu'
[36m(Trainer pid=68093, ip=192.168.14.54)[0m [Debug] Trainer running on node IP: 192.168.14.54
[36m(Trainer pid=68093, ip=192.168.14.54)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=68093, ip=192.168.14.54)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=68093, ip=192.168.14.54)[0m loading train_data and test_data
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.7407 train time 3.1302
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.5950 train time 3.0380
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 0 current_loss: 0.49217143654823303 train_finish_times: [3.130152702331543, 3.037956714630127, 3.0146145820617676]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.4922 train time 3.0146
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.5995065569877625 hit rate: 0.7336471080780029 traveled user hit rate: 0.695652186870575
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.5995065569877625 hit rate: 0.7336471080780029 traveled user hit rate: 0.695652186870575

Predict Day 20 average auc score: 0.5995065569877625 hit rate: 0.7336471080780029
global rounds: 1
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.5995
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7336
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.6957
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4167 train time 3.2822
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3571 train time 3.2682
clientId: 0 current_loss: 0.3069077730178833 train_finish_times: [3.2821764945983887, 3.268188714981079, 3.287492513656616]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3069 train time 3.2875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6193243265151978 hit rate: 0.750265896320343 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6193243265151978 hit rate: 0.750265896320343 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6193243265151978 hit rate: 0.750265896320343
global rounds: 2
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6193
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7503
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2643 train time 3.2817
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2296 train time 3.2816
clientId: 0 current_loss: 0.20349307358264923 train_finish_times: [3.2816836833953857, 3.2816152572631836, 3.245257616043091]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2035 train time 3.2453
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6270771026611328 hit rate: 0.7557966113090515 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6270771026611328 hit rate: 0.7557966113090515 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6270771026611328 hit rate: 0.7557966113090515
global rounds: 3
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6271
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7558
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.1850 train time 3.2642
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.1721 train time 3.2767
clientId: 0 current_loss: 0.1622709482908249 train_finish_times: [3.2641992568969727, 3.2766823768615723, 3.2538909912109375]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.1623 train time 3.2539
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6290178894996643 hit rate: 0.7556902766227722 traveled user hit rate: 0.739130437374115
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6290178894996643 hit rate: 0.7556902766227722 traveled user hit rate: 0.739130437374115

Predict Day 20 average auc score: 0.6290178894996643 hit rate: 0.7556902766227722
global rounds: 4
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6290
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7557
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7391
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.1538 train time 3.2759
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.1457 train time 3.2574
clientId: 0 current_loss: 0.13791799545288086 train_finish_times: [3.275946617126465, 3.2573940753936768, 3.2652478218078613]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.1379 train time 3.2652
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6295909881591797 hit rate: 0.7578972578048706 traveled user hit rate: 0.695652186870575
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6295909881591797 hit rate: 0.7578972578048706 traveled user hit rate: 0.695652186870575

Predict Day 20 average auc score: 0.6295909881591797 hit rate: 0.7578972578048706
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6296
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7579
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.6957
global rounds: 5
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.1308 train time 3.2755
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.1248 train time 3.2786
clientId: 0 current_loss: 0.12006776034832001 train_finish_times: [3.275473117828369, 3.2786202430725098, 3.214017391204834]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.1201 train time 3.2140
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6298767328262329 hit rate: 0.7595192790031433 traveled user hit rate: 0.695652186870575
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6298767328262329 hit rate: 0.7595192790031433 traveled user hit rate: 0.695652186870575

Predict Day 20 average auc score: 0.6298767328262329 hit rate: 0.7595192790031433
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6299
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7595
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.6957
global rounds: 6
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.1159 train time 3.2585
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.1115 train time 3.2574
clientId: 0 current_loss: 0.10637568682432175 train_finish_times: [3.2584593296051025, 3.2574031352996826, 3.2488327026367188]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.1064 train time 3.2488
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6303819417953491 hit rate: 0.7602903842926025 traveled user hit rate: 0.717391312122345
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6303819417953491 hit rate: 0.7602903842926025 traveled user hit rate: 0.717391312122345

Predict Day 20 average auc score: 0.6303819417953491 hit rate: 0.7602903842926025
global rounds: 7
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6304
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7603
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7174
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.1011 train time 3.2751
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.0964 train time 3.2448
clientId: 0 current_loss: 0.09254436939954758 train_finish_times: [3.275132179260254, 3.244774341583252, 3.2512476444244385]
[36m(Trainer pid=68093, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.0925 train time 3.2512
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test AUC: 0.6308
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7608
[36m(Trainer pid=68093, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.6957
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) auc score: 0.6308132410049438 hit rate: 0.7608487606048584 traveled user hit rate: 0.695652186870575
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, adb3bfa1d78d620322fa1da22d000000) final auc score: 0.6308132410049438 hit rate: 0.7608487606048584 traveled user hit rate: 0.695652186870575

Predict Day 20 average auc score: 0.6308132410049438 hit rate: 0.7608487606048584
training is not complete
//train_time: 145908.174 ms//end
//Log Max memory for Large1: 9190731776.0 //end
//Log Max memory for Large2: 4796735488.0 //end
//Log Max memory for Large3: 4783411200.0 //end
//Log Max memory for Large4: 5084766208.0 //end
//Log Max memory for Server: 18612199424.0 //end
//Log Large1 network: 3800741010.0 //end
//Log Large2 network: 2379391.0 //end
//Log Large3 network: 2061985.0 //end
//Log Large4 network: 2031875.0 //end
//Log Server network: 2820007443.0 //end
//Log Total Actual Train Comm Cost: 6320.21 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 4760.96 MB //end
The whole process has ended

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: 4D-FED-GNN+, Countries: US, BR
--------------------------------------------------------------------------------

2025-05-15 00:23:52,055	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:23:52,056	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:23:52,066	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
Downloading data_BR from https://drive.google.com/uc?id=1tg69D1-NSTrKvaAGZELBeECsPh6MAnaS...
Downloading...
From: https://drive.google.com/uc?id=1tg69D1-NSTrKvaAGZELBeECsPh6MAnaS
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_BR.txt

  0%|          | 0.00/57.1M [00:00<?, ?B/s]
  8%|â–Š         | 4.72M/57.1M [00:00<00:01, 37.0MB/s]
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 27.3M/57.1M [00:00<00:00, 136MB/s] 
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 45.1M/57.1M [00:00<00:00, 153MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 57.1M/57.1M [00:00<00:00, 147MB/s]
Downloaded data_BR to data/LPDataset/data_BR.txt
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 17782.896999999997 ms //end
//Log Large1 init network: 218822.0 //end
//Log Large2 init network: 240472.0 //end
//Log Large3 init network: 207839.0 //end
//Log Large4 init network: 208314.0 //end
//Log Server init network: 625191.0 //end
//Log Initialization Communication Cost (MB): 1.43 //end
Pretrain start time recorded.
//pretrain_time: 1169.798 ms//end
[36m(Trainer pid=69067, ip=192.168.42.57)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=69067, ip=192.168.42.57)[0m data/LPDataset not exists, creating directory
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloading traveled_users from https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p...
[36m(Trainer pid=68917, ip=192.168.39.156)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloading...
[36m(Trainer pid=69067, ip=192.168.42.57)[0m From: https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p
[36m(Trainer pid=69067, ip=192.168.42.57)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/traveled_users.txt
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
  0%|          | 0.00/552k [00:00<?, ?B/s]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloaded traveled_users to data/LPDataset/traveled_users.txt
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloading data_global from https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J...
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552k/552k [00:00<00:00, 10.3MB/s]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m From (original): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J
[36m(Trainer pid=69067, ip=192.168.42.57)[0m From (redirected): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J&confirm=t&uuid=822824c9-ee81-415b-84c2-8eab4f4c3ff5
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
  2%|â–         | 6.29M/278M [00:00<00:04, 59.2MB/s]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
  5%|â–Œ         | 14.2M/278M [00:00<00:03, 69.6MB/s]
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloading...[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(Trainer pid=68917, ip=192.168.39.156)[0m From: https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p
[36m(Trainer pid=68917, ip=192.168.39.156)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_global.txt[32m [repeated 3x across cluster][0m
[36m(Trainer pid=68917, ip=192.168.39.156)[0m 
  0%|          | 0.00/278M [00:00<?, ?B/s][32m [repeated 3x across cluster][0m
[36m(Trainer pid=68917, ip=192.168.39.156)[0m 
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 266M/278M [00:01<00:00, 176MB/s]
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloaded data_global to data/LPDataset/data_global.txt
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloading data_US from https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd...
[36m(Trainer pid=68917, ip=192.168.39.156)[0m data/LPDataset not exists, creating directory
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloading traveled_users from https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p...
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloaded traveled_users to data/LPDataset/traveled_users.txt
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloading data_global from https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J...
[36m(Trainer pid=68917, ip=192.168.39.156)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 278M/278M [00:01<00:00, 175MB/s]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloading data_BR from https://drive.google.com/uc?id=1tg69D1-NSTrKvaAGZELBeECsPh6MAnaS...
[36m(Trainer pid=68917, ip=192.168.39.156)[0m From (original): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd[32m [repeated 2x across cluster][0m
[36m(Trainer pid=68917, ip=192.168.39.156)[0m From (redirected): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd&confirm=t&uuid=46d7af04-6573-438e-a378-7499b457f75f[32m [repeated 2x across cluster][0m
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 242M/278M [00:01<00:00, 145MB/s][32m [repeated 26x across cluster][0m
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloaded data_US to data/LPDataset/data_US.txt
[36m(Trainer pid=68917, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Downloading...
[36m(Trainer pid=68917, ip=192.168.39.156)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_US.txt
[36m(Trainer pid=68917, ip=192.168.39.156)[0m 
  0%|          | 0.00/118M [00:00<?, ?B/s]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloading...
[36m(Trainer pid=69067, ip=192.168.42.57)[0m From: https://drive.google.com/uc?id=1tg69D1-NSTrKvaAGZELBeECsPh6MAnaS
[36m(Trainer pid=69067, ip=192.168.42.57)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_BR.txt
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
  0%|          | 0.00/57.1M [00:00<?, ?B/s]
[36m(Trainer pid=68917, ip=192.168.39.156)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 118M/118M [00:00<00:00, 162MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 118M/118M [00:00<00:00, 127MB/s][32m [repeated 3x across cluster][0m
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloaded data_BR to data/LPDataset/data_BR.txt
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Downloaded data_global to data/LPDataset/data_global.txt
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=69067, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=69067, ip=192.168.42.57)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=69067, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=69067, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 41.9M/57.1M [00:00<00:00, 143MB/s][32m [repeated 11x across cluster][0m
[36m(Trainer pid=69067, ip=192.168.42.57)[0m 
 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 56.6M/57.1M [00:00<00:00, 137MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 57.1M/57.1M [00:00<00:00, 134MB/s]
//Log Max memory for Large1: 6030352384.0 //end
//Log Max memory for Large2: 4795518976.0 //end
//Log Max memory for Large3: 5513793536.0 //end
//Log Max memory for Large4: 5922258944.0 //end
//Log Max memory for Server: 18365648896.0 //end
//Log Large1 network: 374619.0 //end
//Log Large2 network: 414655.0 //end
//Log Large3 network: 154293197.0 //end
//Log Large4 network: 154231447.0 //end
//Log Server network: 162056098.0 //end
//Log Total Actual Pretrain Comm Cost: 449.53 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m loading train_data and test_data
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.7951 train time 3.1435
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Device: 'cpu'
[36m(Trainer pid=68917, ip=192.168.39.156)[0m [Debug] Trainer running on node IP: 192.168.39.156
[36m(Trainer pid=68917, ip=192.168.39.156)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=68917, ip=192.168.39.156)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.6490 train time 3.0224
[36m(Trainer pid=68917, ip=192.168.39.156)[0m loading train_data and test_data
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 1 current_loss: 0.5300016403198242 train_finish_times: [3.143522024154663, 3.022373914718628, 3.042773485183716]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.5300 train time 3.0428
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 0 loss 0.7980 train time 3.3160
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 1 loss 0.6582 train time 3.2980
clientId: 0 current_loss: 0.5454177260398865 train_finish_times: [3.3160293102264404, 3.298007011413574, 3.3096871376037598]
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.5454 train time 3.3097
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.6301296949386597 hit rate: 0.7645938396453857 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.6301296949386597 hit rate: 0.7645938396453857 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.6301
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.7646
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.5869616270065308 hit rate: 0.7214954495429993 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.5869616270065308 hit rate: 0.7214954495429993 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.6085456609725952 hit rate: 0.7430446147918701
global rounds: 1
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.4354 train time 3.0345
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.5870
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7215
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7609
clientId: 1 current_loss: 0.2816919684410095 train_finish_times: [3.034498691558838, 3.054677963256836, 3.032195568084717]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2817 train time 3.0322[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.3136627674102783 train_finish_times: [3.3077661991119385, 3.2243568897247314, 3.2455761432647705]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.6838
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8042
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3137 train time 3.2456
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.6837868690490723 hit rate: 0.8041910529136658 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.6837868690490723 hit rate: 0.8041910529136658 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.6204431056976318 hit rate: 0.7513294816017151 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.6204431056976318 hit rate: 0.7513294816017151 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.652114987373352 hit rate: 0.7777602672576904
global rounds: 2
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2312 train time 3.0541
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6204
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7513
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7609
clientId: 1 current_loss: 0.15091216564178467 train_finish_times: [3.054109811782837, 3.071080446243286, 3.085659980773926]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.1509 train time 3.0857[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.19735988974571228 train_finish_times: [3.2810323238372803, 3.2056291103363037, 3.2392258644104004]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.6971814632415771 hit rate: 0.8186147809028625 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.6971814632415771 hit rate: 0.8186147809028625 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.6972
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8186
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.1974 train time 3.2392
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.6285109519958496 hit rate: 0.7569931745529175 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.6285109519958496 hit rate: 0.7569931745529175 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6628462076187134 hit rate: 0.7878040075302124
global rounds: 3
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.1278 train time 3.0831
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6285
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7570
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7826
clientId: 1 current_loss: 0.09229009598493576 train_finish_times: [3.0831055641174316, 3.103513479232788, 3.097039222717285]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.0923 train time 3.0970[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.1511339545249939 train_finish_times: [3.3520562648773193, 3.323554277420044, 3.326709270477295]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.7003977298736572 hit rate: 0.8229691386222839 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.7003977298736572 hit rate: 0.8229691386222839 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.7004
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8230
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.1511 train time 3.3267
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.630326509475708 hit rate: 0.7580035924911499 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.630326509475708 hit rate: 0.7580035924911499 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.6653621196746826 hit rate: 0.7904863357543945
global rounds: 4
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.0838 train time 3.0993
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6303
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7580
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7609
clientId: 1 current_loss: 0.07114475220441818 train_finish_times: [3.099318742752075, 3.077078104019165, 3.0862433910369873]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.0711 train time 3.0862[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.13419879972934723 train_finish_times: [3.331620693206787, 3.32832932472229, 3.3085718154907227]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.7012035250663757 hit rate: 0.827391505241394 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.7012035250663757 hit rate: 0.827391505241394 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.7012
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8274
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.1342 train time 3.3086
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.6307536363601685 hit rate: 0.7588013410568237 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.6307536363601685 hit rate: 0.7588013410568237 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6659785509109497 hit rate: 0.7930964231491089
global rounds: 5
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.0681 train time 3.1171
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6308
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7588
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7826
clientId: 1 current_loss: 0.06217750534415245 train_finish_times: [3.117109537124634, 3.0963289737701416, 3.097416400909424]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.0622 train time 3.0974[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.12451228499412537 train_finish_times: [3.361703872680664, 3.308666706085205, 3.2851526737213135]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.7014305591583252 hit rate: 0.8262348771095276 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.7014305591583252 hit rate: 0.8262348771095276 traveled user hit rate: 1.0

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.7014
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8262
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.1245 train time 3.2852
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.6309279799461365 hit rate: 0.7607955932617188 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.6309279799461365 hit rate: 0.7607955932617188 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6661792993545532 hit rate: 0.7935152053833008
global rounds: 6
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.0623 train time 3.0700
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6309
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7608
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7826
clientId: 1 current_loss: 0.056522760540246964 train_finish_times: [3.070039749145508, 3.0760679244995117, 3.09226131439209]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.0565 train time 3.0923[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.11760225892066956 train_finish_times: [3.351870059967041, 3.3249387741088867, 3.3337161540985107]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.701622486114502 hit rate: 0.8252143263816833 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.701622486114502 hit rate: 0.8252143263816833 traveled user hit rate: 1.0

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.7016
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8252
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.1176 train time 3.3337
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.6310712099075317 hit rate: 0.7605562806129456 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.6310712099075317 hit rate: 0.7605562806129456 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.6663468480110168 hit rate: 0.7928853034973145
global rounds: 7
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.0577 train time 3.0773
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6311
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7606
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
clientId: 1 current_loss: 0.051792971789836884 train_finish_times: [3.0773062705993652, 3.0999374389648438, 3.0764734745025635]
[36m(Trainer pid=69067, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.0518 train time 3.0765[32m [repeated 4x across cluster][0m
clientId: 0 current_loss: 0.10771622508764267 train_finish_times: [3.3522226810455322, 3.353846549987793, 3.329890251159668]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) auc score: 0.701863169670105 hit rate: 0.8260307312011719 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b4c1fbccbfaa8b408cc364c2e000000) final auc score: 0.701863169670105 hit rate: 0.8260307312011719 traveled user hit rate: 1.0

[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test AUC: 0.7019
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8260
[36m(Trainer pid=69067, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=68917, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.1077 train time 3.3299
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) auc score: 0.6311964392662048 hit rate: 0.7602105736732483 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 999d6ff09f1a856bf00da2ec2e000000) final auc score: 0.6311964392662048 hit rate: 0.7602105736732483 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.6665297746658325 hit rate: 0.7931206226348877
training is not complete
//train_time: 160341.014 ms//end
//Log Max memory for Large1: 6030852096.0 //end
//Log Max memory for Large2: 4796796928.0 //end
//Log Max memory for Large3: 9354510336.0 //end
//Log Max memory for Large4: 9365630976.0 //end
//Log Max memory for Server: 18718023680.0 //end
//Log Large1 network: 2270167.0 //end
//Log Large2 network: 2558955.0 //end
//Log Large3 network: 3878153607.0 //end
//Log Large4 network: 3916276063.0 //end
//Log Server network: 5534945643.0 //end
//Log Total Actual Train Comm Cost: 12716.49 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 9521.92 MB //end
The whole process has ended
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test AUC: 0.6312
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7602
[36m(Trainer pid=68917, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: 4D-FED-GNN+, Countries: US, BR, ID, TR, JP
--------------------------------------------------------------------------------

2025-05-15 00:27:56,670	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:27:56,670	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:27:56,679	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
Downloading data_ID from https://drive.google.com/uc?id=17EIuBl6rI3LNByamO8Dd-yNMUtIJw4xW...
Downloading...
From: https://drive.google.com/uc?id=17EIuBl6rI3LNByamO8Dd-yNMUtIJw4xW
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_ID.txt

  0%|          | 0.00/43.9M [00:00<?, ?B/s]
 21%|â–ˆâ–ˆâ–       | 9.44M/43.9M [00:00<00:00, 92.7MB/s]
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 30.9M/43.9M [00:00<00:00, 160MB/s] 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43.9M/43.9M [00:00<00:00, 166MB/s]
Downloaded data_ID to data/LPDataset/data_ID.txt
Downloading data_TR from https://drive.google.com/uc?id=1Tz2ckCrEHy0wn075JRYtKE9MNIyd6nTx...
Downloading...
From: https://drive.google.com/uc?id=1Tz2ckCrEHy0wn075JRYtKE9MNIyd6nTx
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_TR.txt

  0%|          | 0.00/30.0M [00:00<?, ?B/s]
 14%|â–ˆâ–        | 4.19M/30.0M [00:00<00:00, 41.1MB/s]
 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 15.2M/30.0M [00:00<00:00, 79.5MB/s]
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 26.2M/30.0M [00:00<00:00, 91.8MB/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0M/30.0M [00:00<00:00, 88.0MB/s]
Downloaded data_TR to data/LPDataset/data_TR.txt
Downloading data_JP from https://drive.google.com/uc?id=1IPBW4dRYk52x8TahfBqFOh3GdxoYafJ2...
Downloading...
From: https://drive.google.com/uc?id=1IPBW4dRYk52x8TahfBqFOh3GdxoYafJ2
To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_JP.txt

  0%|          | 0.00/28.7M [00:00<?, ?B/s]
 16%|â–ˆâ–‹        | 4.72M/28.7M [00:00<00:00, 46.6MB/s]
 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 21.0M/28.7M [00:00<00:00, 114MB/s] 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28.7M/28.7M [00:00<00:00, 111MB/s]
Downloaded data_JP to data/LPDataset/data_JP.txt
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 25475.759000000002 ms //end
//Log Large1 init network: 267913.0 //end
//Log Large2 init network: 428236.0 //end
//Log Large3 init network: 314551.0 //end
//Log Large4 init network: 315262.0 //end
//Log Server init network: 1000143.0 //end
//Log Initialization Communication Cost (MB): 2.22 //end
Pretrain start time recorded.
//pretrain_time: 2984.794 ms//end
[36m(Trainer pid=70215, ip=192.168.14.54)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Downloading data_BR from https://drive.google.com/uc?id=1tg69D1-NSTrKvaAGZELBeECsPh6MAnaS...
[36m(Trainer pid=70209, ip=192.168.42.57)[0m checking code and file path: TR,data/LPDataset
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Downloading data_TR from https://drive.google.com/uc?id=1Tz2ckCrEHy0wn075JRYtKE9MNIyd6nTx...
[36m(Trainer pid=74108, ip=192.168.14.62)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=74108, ip=192.168.14.62)[0m data/LPDataset not exists, creating directory
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloading traveled_users from https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p...
[36m(Trainer pid=70065, ip=192.168.39.156)[0m checking code and file path: ID,data/LPDataset
[36m(Trainer pid=70065, ip=192.168.39.156)[0m Downloading data_ID from https://drive.google.com/uc?id=17EIuBl6rI3LNByamO8Dd-yNMUtIJw4xW...
[36m(Trainer pid=74113, ip=192.168.14.62)[0m checking code and file path: JP,data/LPDataset
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Downloading...
[36m(Trainer pid=70209, ip=192.168.42.57)[0m From: https://drive.google.com/uc?id=1Tz2ckCrEHy0wn075JRYtKE9MNIyd6nTx
[36m(Trainer pid=70209, ip=192.168.42.57)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_TR.txt
[36m(Trainer pid=70209, ip=192.168.42.57)[0m 
  0%|          | 0.00/30.0M [00:00<?, ?B/s]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m 
 35%|â–ˆâ–ˆâ–ˆâ–      | 10.5M/30.0M [00:00<00:00, 101MB/s]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Downloaded data_TR to data/LPDataset/data_TR.txt
[36m(Trainer pid=70209, ip=192.168.42.57)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_TR.txt
[36m(Trainer pid=70209, ip=192.168.42.57)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 30.0M/30.0M [00:00<00:00, 167MB/s]
[36m(Trainer pid=70065, ip=192.168.39.156)[0m Downloaded data_ID to data/LPDataset/data_ID.txt
[36m(Trainer pid=70065, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_ID.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloaded traveled_users to data/LPDataset/traveled_users.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloading data_global from https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J...
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Downloaded data_BR to data/LPDataset/data_BR.txt
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m From (original): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J
[36m(Trainer pid=74108, ip=192.168.14.62)[0m From (redirected): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J&confirm=t&uuid=974c7eee-9f6e-401e-8a6c-9e7100530c94
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloading...[32m [repeated 6x across cluster][0m
[36m(Trainer pid=70215, ip=192.168.14.54)[0m From: https://drive.google.com/uc?id=1tg69D1-NSTrKvaAGZELBeECsPh6MAnaS[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_global.txt[32m [repeated 6x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m 
  0%|          | 0.00/278M [00:00<?, ?B/s][32m [repeated 6x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m 
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 175M/278M [00:00<00:00, 216MB/s][32m [repeated 18x across cluster][0m
[36m(Trainer pid=70065, ip=192.168.39.156)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 43.9M/43.9M [00:00<00:00, 165MB/s]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=70209, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloading traveled_users from https://drive.google.com/uc?id=1RUsyGrsz4hmY3OA3b-oqyh5yqlks02-p...
[36m(Trainer pid=70215, ip=192.168.14.54)[0m printing in getdata, path: data/LPDataset[32m [repeated 2x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m 
 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 261M/278M [00:01<00:00, 202MB/s]
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloaded data_global to data/LPDataset/data_global.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloading data_US from https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd...
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloaded traveled_users to data/LPDataset/traveled_users.txt
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloading data_global from https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J...
[36m(Trainer pid=74108, ip=192.168.14.62)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 278M/278M [00:01<00:00, 206MB/s]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=70209, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloading data_JP from https://drive.google.com/uc?id=1IPBW4dRYk52x8TahfBqFOh3GdxoYafJ2...
[36m(Trainer pid=74113, ip=192.168.14.62)[0m From (original): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J
[36m(Trainer pid=74113, ip=192.168.14.62)[0m From (redirected): https://drive.google.com/uc?id=1CnBlVXqCbfjSswagTci5D7nAqO7laU_J&confirm=t&uuid=bc3cd563-ea34-4e15-9e35-c4d91063091d
[36m(Trainer pid=74108, ip=192.168.14.62)[0m From (original): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd
[36m(Trainer pid=74108, ip=192.168.14.62)[0m From (redirected): https://drive.google.com/uc?id=1g3nH-UovAFwj4wKLTr4rBP18hlBtVJLd&confirm=t&uuid=9ff4cae5-8556-4fca-a3d8-683e695de8d3
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloaded data_JP to data/LPDataset/data_JP.txt
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_JP.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloading...[32m [repeated 2x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m From: https://drive.google.com/uc?id=1IPBW4dRYk52x8TahfBqFOh3GdxoYafJ2
[36m(Trainer pid=74108, ip=192.168.14.62)[0m To: /tmp/ray/session_2025-05-14_20-44-36_016650_1/runtime_resources/working_dir_files/_ray_pkg_f82b624e2786f519/data/LPDataset/data_US.txt[32m [repeated 2x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m 
  0%|          | 0.00/118M [00:00<?, ?B/s][32m [repeated 2x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m 
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 107M/118M [00:00<00:00, 197MB/s] [32m [repeated 18x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Downloaded data_US to data/LPDataset/data_US.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=74108, ip=192.168.14.62)[0m 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 118M/118M [00:00<00:00, 169MB/s][32m [repeated 5x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Device: 'cpu'[32m [repeated 3x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m [Debug] Trainer running on node IP: 192.168.14.62[32m [repeated 3x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m printing in getdata, path: data/LPDataset[32m [repeated 2x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Downloaded data_global to data/LPDataset/data_global.txt
[36m(Trainer pid=74113, ip=192.168.14.62)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.[32m [repeated 3x across cluster][0m
[36m(Trainer pid=74113, ip=192.168.14.62)[0m   return torch.load(io.BytesIO(b))[32m [repeated 3x across cluster][0m
//Log Max memory for Large1: 6279888896.0 //end
//Log Max memory for Large2: 5469589504.0 //end
//Log Max memory for Large3: 6022881280.0 //end
//Log Max memory for Large4: 6263291904.0 //end
//Log Max memory for Server: 18747551744.0 //end
//Log Large1 network: 191899207.0 //end
//Log Large2 network: 384345357.0 //end
//Log Large3 network: 191579686.0 //end
//Log Large4 network: 191682919.0 //end
//Log Server network: 1404743437.0 //end
//Log Total Actual Pretrain Comm Cost: 2254.73 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74113, ip=192.168.14.62)[0m loading train_data and test_data
[36m(Trainer pid=74113, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.9259 train time 3.1889
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Device: 'cpu'
[36m(Trainer pid=74108, ip=192.168.14.62)[0m [Debug] Trainer running on node IP: 192.168.14.62
[36m(Trainer pid=74108, ip=192.168.14.62)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=74108, ip=192.168.14.62)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=74108, ip=192.168.14.62)[0m loading train_data and test_data[32m [repeated 4x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 1 current_loss: 0.667594850063324 train_finish_times: [3.1776182651519775, 3.1210451126098633, 3.140821933746338]
clientId: 3 current_loss: 0.6584154367446899 train_finish_times: [3.217623233795166, 3.1311142444610596, 3.1447596549987793]
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.6676 train time 3.1408[32m [repeated 9x across cluster][0m
clientId: 4 current_loss: 0.6676526665687561 train_finish_times: [3.1888694763183594, 3.148261547088623, 3.208632707595825]
clientId: 2 current_loss: 0.6658592224121094 train_finish_times: [3.2668721675872803, 3.1314008235931396, 3.1418116092681885]
clientId: 0 current_loss: 0.669937252998352 train_finish_times: [3.475914716720581, 3.297391891479492, 3.2908363342285156]
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.6699 train time 3.2908[32m [repeated 5x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.6069262027740479 hit rate: 0.759315013885498 traveled user hit rate: 0.8333333134651184
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.6069262027740479 hit rate: 0.759315013885498 traveled user hit rate: 0.8333333134651184

[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test AUC: 0.6069
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.7593
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8333
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.569318413734436 hit rate: 0.7051979899406433 traveled user hit rate: 0.6000000238418579
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.569318413734436 hit rate: 0.7051979899406433 traveled user hit rate: 0.6000000238418579

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.5688661336898804 hit rate: 0.7112609148025513 traveled user hit rate: 0.4285714328289032
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.5688661336898804 hit rate: 0.7112609148025513 traveled user hit rate: 0.4285714328289032

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.5683800578117371 hit rate: 0.7103158831596375 traveled user hit rate: 0.5
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.5683800578117371 hit rate: 0.7103158831596375 traveled user hit rate: 0.5

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.5453467965126038 hit rate: 0.6809455156326294 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.5453467965126038 hit rate: 0.6809455156326294 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.5717675089836121 hit rate: 0.7134071588516235
global rounds: 1
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 0 loss 0.5686 train time 3.1164
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.5453[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.6809[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7826[32m [repeated 4x across cluster][0m
clientId: 1 current_loss: 0.3920551538467407 train_finish_times: [3.116389036178589, 3.126842975616455, 3.1307854652404785]
clientId: 3 current_loss: 0.3911312222480774 train_finish_times: [3.1105055809020996, 3.1499969959259033, 3.1235742568969727]
clientId: 2 current_loss: 0.3914334774017334 train_finish_times: [3.1237661838531494, 3.1448683738708496, 3.124295949935913]
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.3921 train time 3.1308[32m [repeated 10x across cluster][0m
clientId: 4 current_loss: 0.40940728783607483 train_finish_times: [3.168755054473877, 3.213887929916382, 3.211338758468628]
clientId: 0 current_loss: 0.4084104895591736 train_finish_times: [3.379833936691284, 3.402254819869995, 3.394181251525879]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.7518467903137207 hit rate: 0.8843473196029663 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.7518467903137207 hit rate: 0.8843473196029663 traveled user hit rate: 1.0

[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test AUC: 0.7518
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8843
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4084 train time 3.3942[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.6638075113296509 hit rate: 0.791536271572113 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.6638075113296509 hit rate: 0.791536271572113 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.6672624945640564 hit rate: 0.7967826128005981 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.6672624945640564 hit rate: 0.7967826128005981 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.6648104190826416 hit rate: 0.7971984148025513 traveled user hit rate: 0.625
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.6648104190826416 hit rate: 0.7971984148025513 traveled user hit rate: 0.625

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6069664359092712 hit rate: 0.7455860376358032 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6069664359092712 hit rate: 0.7455860376358032 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6709387302398682 hit rate: 0.8030900955200195
global rounds: 2
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6070[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7456[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7826[32m [repeated 4x across cluster][0m
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 0 loss 0.3287 train time 3.1326
[36m(Trainer pid=70065, ip=192.168.39.156)[0m client 2 local steps 0 loss 0.3286 train time 3.1578
clientId: 1 current_loss: 0.21781757473945618 train_finish_times: [3.132627010345459, 3.139329195022583, 3.130751848220825]
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.2178 train time 3.1308[32m [repeated 9x across cluster][0m
clientId: 2 current_loss: 0.21831031143665314 train_finish_times: [3.157764434814453, 3.168077230453491, 3.1549746990203857]
clientId: 3 current_loss: 0.21417172253131866 train_finish_times: [3.1672492027282715, 3.1783382892608643, 3.1704273223876953]
clientId: 4 current_loss: 0.23576390743255615 train_finish_times: [3.2133402824401855, 3.2417337894439697, 3.2306294441223145]
clientId: 0 current_loss: 0.25034981966018677 train_finish_times: [3.4368698596954346, 3.4307734966278076, 3.421750545501709]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.6942141056060791 hit rate: 0.8180742859840393 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.6942141056060791 hit rate: 0.8180742859840393 traveled user hit rate: 0.8571428656578064

[36m(Trainer pid=74113, ip=192.168.14.62)[0m Test AUC: 0.6942
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8181
[36m(Trainer pid=74113, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8571
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.2503 train time 3.4218[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.6917400360107422 hit rate: 0.8124914765357971 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.6917400360107422 hit rate: 0.8124914765357971 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.7909468412399292 hit rate: 0.9061182141304016 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.7909468412399292 hit rate: 0.9061182141304016 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.6921247839927673 hit rate: 0.8160267472267151 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.6921247839927673 hit rate: 0.8160267472267151 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6242020726203918 hit rate: 0.7564082145690918 traveled user hit rate: 0.739130437374115
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6242020726203918 hit rate: 0.7564082145690918 traveled user hit rate: 0.739130437374115

Predict Day 20 average auc score: 0.6986455321311951 hit rate: 0.82182377576828
global rounds: 3
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6242[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7564[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7391[32m [repeated 4x across cluster][0m
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 0 loss 0.1812 train time 3.1391
[36m(Trainer pid=70065, ip=192.168.39.156)[0m client 2 local steps 0 loss 0.1820 train time 3.1591
clientId: 1 current_loss: 0.12217744439840317 train_finish_times: [3.1391446590423584, 3.145709753036499, 3.1394059658050537]
clientId: 3 current_loss: 0.11168991774320602 train_finish_times: [3.145035982131958, 3.152614116668701, 3.13065767288208]
clientId: 2 current_loss: 0.12457094341516495 train_finish_times: [3.159085988998413, 3.1511354446411133, 3.1671230792999268]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 2 loss 0.1117 train time 3.1307[32m [repeated 9x across cluster][0m
clientId: 4 current_loss: 0.13236379623413086 train_finish_times: [3.227398633956909, 3.2596821784973145, 3.2819623947143555]
clientId: 0 current_loss: 0.17209318280220032 train_finish_times: [3.4172558784484863, 3.431671619415283, 3.4708642959594727]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.6989784836769104 hit rate: 0.8174581527709961 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.6989784836769104 hit rate: 0.8174581527709961 traveled user hit rate: 1.0

[36m(Trainer pid=70215, ip=192.168.14.54)[0m Test AUC: 0.6990
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8175
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.1721 train time 3.4709[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.7004565000534058 hit rate: 0.8223326206207275 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.7004565000534058 hit rate: 0.8223326206207275 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.6990059614181519 hit rate: 0.8207338452339172 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.6990059614181519 hit rate: 0.8207338452339172 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.8002526164054871 hit rate: 0.9105929136276245 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.8002526164054871 hit rate: 0.9105929136276245 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6287194490432739 hit rate: 0.7585886120796204 traveled user hit rate: 0.717391312122345
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6287194490432739 hit rate: 0.7585886120796204 traveled user hit rate: 0.717391312122345

Predict Day 20 average auc score: 0.7054826617240906 hit rate: 0.825941264629364
global rounds: 4
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6287[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7586[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7174[32m [repeated 4x across cluster][0m
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.0946 train time 3.1591
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 0 loss 0.1062 train time 3.1525
clientId: 1 current_loss: 0.08237241953611374 train_finish_times: [3.152519702911377, 3.1615800857543945, 3.163706064224243]
clientId: 3 current_loss: 0.06543054431676865 train_finish_times: [3.159140110015869, 3.165785312652588, 3.1656312942504883]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 2 loss 0.0654 train time 3.1656[32m [repeated 9x across cluster][0m
clientId: 2 current_loss: 0.0866783931851387 train_finish_times: [3.1834282875061035, 3.1811046600341797, 3.1785638332366943]
clientId: 4 current_loss: 0.08459576964378357 train_finish_times: [3.248197078704834, 3.279885768890381, 3.2434191703796387]
clientId: 0 current_loss: 0.14561264216899872 train_finish_times: [3.452385187149048, 3.4760942459106445, 3.4618375301361084]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.7009931802749634 hit rate: 0.8152129650115967 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.7009931802749634 hit rate: 0.8152129650115967 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.8024317622184753 hit rate: 0.9118836522102356 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.8024317622184753 hit rate: 0.9118836522102356 traveled user hit rate: 1.0

[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test AUC: 0.8024
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9119
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.1456 train time 3.4618[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.7017794847488403 hit rate: 0.8245800733566284 traveled user hit rate: 0.7142857313156128
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.7017794847488403 hit rate: 0.8245800733566284 traveled user hit rate: 0.7142857313156128

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.7007606029510498 hit rate: 0.8218680620193481 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.7007606029510498 hit rate: 0.8218680620193481 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6299329996109009 hit rate: 0.7595458626747131 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6299329996109009 hit rate: 0.7595458626747131 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.7071796655654907 hit rate: 0.8266180753707886
global rounds: 5
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6299[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7595[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7609[32m [repeated 4x across cluster][0m
[36m(Trainer pid=70065, ip=192.168.39.156)[0m client 2 local steps 0 loss 0.0832 train time 3.1704
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.0598 train time 3.2053
clientId: 1 current_loss: 0.06989384442567825 train_finish_times: [3.1614861488342285, 3.170325517654419, 3.171062707901001]
clientId: 2 current_loss: 0.07543838024139404 train_finish_times: [3.170384168624878, 3.190314292907715, 3.1599032878875732]
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.0699 train time 3.1711[32m [repeated 9x across cluster][0m
clientId: 3 current_loss: 0.04907432571053505 train_finish_times: [3.2053451538085938, 3.2152509689331055, 3.206665515899658]
clientId: 4 current_loss: 0.06737585365772247 train_finish_times: [3.227670431137085, 3.2755722999572754, 3.2682223320007324]
clientId: 0 current_loss: 0.1382584273815155 train_finish_times: [3.4434192180633545, 3.4649012088775635, 3.4595699310302734]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.8029707074165344 hit rate: 0.9111952781677246 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.8029707074165344 hit rate: 0.9111952781677246 traveled user hit rate: 1.0

[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test AUC: 0.8030
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9112
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.1383 train time 3.4596[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.7016885876655579 hit rate: 0.8163015246391296 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.7016885876655579 hit rate: 0.8163015246391296 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.7019844055175781 hit rate: 0.824461817741394 traveled user hit rate: 0.7142857313156128
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.7019844055175781 hit rate: 0.824461817741394 traveled user hit rate: 0.7142857313156128

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.7012919187545776 hit rate: 0.8206771612167358 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.7012919187545776 hit rate: 0.8206771612167358 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6303393840789795 hit rate: 0.7582694888114929 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6303393840789795 hit rate: 0.7582694888114929 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.7076550126075745 hit rate: 0.8261810541152954
global rounds: 6
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6303[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7583[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7609[32m [repeated 4x across cluster][0m
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.0478 train time 3.2031
[36m(Trainer pid=70065, ip=192.168.39.156)[0m client 2 local steps 0 loss 0.0758 train time 3.1788
clientId: 2 current_loss: 0.07135411351919174 train_finish_times: [3.178823471069336, 3.1763217449188232, 3.1776373386383057]
clientId: 1 current_loss: 0.06523481756448746 train_finish_times: [3.1914589405059814, 3.157493829727173, 3.1849560737609863]
[36m(Trainer pid=70215, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.0652 train time 3.1850[32m [repeated 9x across cluster][0m
clientId: 3 current_loss: 0.04327942803502083 train_finish_times: [3.2031497955322266, 3.1977756023406982, 3.2199015617370605]
clientId: 4 current_loss: 0.060943059623241425 train_finish_times: [3.250861167907715, 3.272265911102295, 3.285282850265503]
clientId: 0 current_loss: 0.13460011780261993 train_finish_times: [3.451345205307007, 3.4458742141723633, 3.4604527950286865]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.7020211219787598 hit rate: 0.8179343938827515 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.7020211219787598 hit rate: 0.8179343938827515 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.8031259775161743 hit rate: 0.911711573600769 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.8031259775161743 hit rate: 0.911711573600769 traveled user hit rate: 1.0

[36m(Trainer pid=70215, ip=192.168.14.54)[0m Test AUC: 0.7020
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8179
[36m(Trainer pid=70215, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8000
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.1346 train time 3.4605[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.701996922492981 hit rate: 0.8243435025215149 traveled user hit rate: 0.7142857313156128
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.701996922492981 hit rate: 0.8243435025215149 traveled user hit rate: 0.7142857313156128

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.7015108466148376 hit rate: 0.8205069899559021 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.7015108466148376 hit rate: 0.8205069899559021 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6305574178695679 hit rate: 0.7580568194389343 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6305574178695679 hit rate: 0.7580568194389343 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.7078424692153931 hit rate: 0.8265106081962585
global rounds: 7
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6306[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7581[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7609[32m [repeated 4x across cluster][0m
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.0438 train time 3.1561
[36m(Trainer pid=70065, ip=192.168.39.156)[0m client 2 local steps 0 loss 0.0725 train time 3.1818
clientId: 3 current_loss: 0.0402691587805748 train_finish_times: [3.1561474800109863, 3.172595262527466, 3.1698720455169678]
clientId: 1 current_loss: 0.06196937710046768 train_finish_times: [3.1593527793884277, 3.1839520931243896, 3.178417921066284]
clientId: 2 current_loss: 0.0684933140873909 train_finish_times: [3.18184494972229, 3.1795899868011475, 3.1705355644226074]
[36m(Trainer pid=70209, ip=192.168.42.57)[0m client 3 local steps 2 loss 0.0403 train time 3.1699[32m [repeated 9x across cluster][0m
clientId: 4 current_loss: 0.057279448956251144 train_finish_times: [3.247886896133423, 3.2948622703552246, 3.2817206382751465]
clientId: 0 current_loss: 0.1323307752609253 train_finish_times: [3.4311323165893555, 3.503366470336914, 3.4695894718170166]
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) auc score: 0.8031840324401855 hit rate: 0.9112812876701355 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4a7f213e1f9d7dfcbfe258db2f000000) final auc score: 0.8031840324401855 hit rate: 0.9112812876701355 traveled user hit rate: 1.0

[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test AUC: 0.8032
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9113
[36m(Trainer pid=70209, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
[36m(Trainer pid=74108, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.1323 train time 3.4696[32m [repeated 4x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) auc score: 0.7020400762557983 hit rate: 0.8267092704772949 traveled user hit rate: 0.7142857313156128
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, dd0641b9c42fd6f9f8c1e6522f000000) final auc score: 0.7020400762557983 hit rate: 0.8267092704772949 traveled user hit rate: 0.7142857313156128

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) auc score: 0.7022269368171692 hit rate: 0.8190230131149292 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 085eab3b4303fa0fc816a8882f000000) final auc score: 0.7022269368171692 hit rate: 0.8190230131149292 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) auc score: 0.7016430497169495 hit rate: 0.8202234506607056 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bd22da2f79fc09f753fff6ad2f000000) final auc score: 0.7016430497169495 hit rate: 0.8202234506607056 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) auc score: 0.6307547092437744 hit rate: 0.7580568194389343 traveled user hit rate: 0.739130437374115
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 0248cc82c55c36e6e631f6a62f000000) final auc score: 0.6307547092437744 hit rate: 0.7580568194389343 traveled user hit rate: 0.739130437374115

Predict Day 20 average auc score: 0.7079697847366333 hit rate: 0.8270586729049683
training is not complete
//train_time: 196233.26 ms//end
//Log Max memory for Large1: 10400030720.0 //end
//Log Max memory for Large2: 12968329216.0 //end
//Log Max memory for Large3: 9664016384.0 //end
//Log Max memory for Large4: 10140856320.0 //end
//Log Max memory for Server: 18884050944.0 //end
//Log Large1 network: 4078117480.0 //end
//Log Large2 network: 8083768317.0 //end
//Log Large3 network: 4091335652.0 //end
//Log Large4 network: 4085110199.0 //end
//Log Server network: 12836155831.0 //end
//Log Total Actual Train Comm Cost: 31637.66 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 23804.80 MB //end
The whole process has ended
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test AUC: 0.6308[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7581[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74108, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7391[32m [repeated 4x across cluster][0m

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: STFL, Countries: US
--------------------------------------------------------------------------------

2025-05-15 00:32:47,011	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:32:47,013	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:32:47,020	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 11747.47 ms //end
//Log Large1 init network: 157836.0 //end
//Log Large2 init network: 183551.0 //end
//Log Large3 init network: 157976.0 //end
//Log Large4 init network: 158894.0 //end
//Log Server init network: 280048.0 //end
//Log Initialization Communication Cost (MB): 0.89 //end
Pretrain start time recorded.
//pretrain_time: 583.684 ms//end
[36m(Trainer pid=71462, ip=192.168.14.54)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=71462, ip=192.168.14.54)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Device: 'cpu'
[36m(Trainer pid=71462, ip=192.168.14.54)[0m [Debug] Trainer running on node IP: 192.168.14.54
[36m(Trainer pid=71462, ip=192.168.14.54)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=71462, ip=192.168.14.54)[0m   return torch.load(io.BytesIO(b))
//Log Max memory for Large1: 7403368448.0 //end
//Log Max memory for Large2: 5864906752.0 //end
//Log Max memory for Large3: 5784653824.0 //end
//Log Max memory for Large4: 5961482240.0 //end
//Log Max memory for Server: 18513580032.0 //end
//Log Large1 network: 191481591.0 //end
//Log Large2 network: 440588.0 //end
//Log Large3 network: 342815.0 //end
//Log Large4 network: 377434.0 //end
//Log Server network: 344308371.0 //end
//Log Total Actual Pretrain Comm Cost: 512.08 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m loading train_data and test_data
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.7523 train time 7.3914
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.6836 train time 7.3288
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 0 current_loss: 0.6273417472839355 train_finish_times: [7.391431093215942, 7.328848361968994, 7.302522420883179]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.6273 train time 7.3025
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.6111809611320496 hit rate: 0.7496011257171631 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.6111809611320496 hit rate: 0.7496011257171631 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.6111809611320496 hit rate: 0.7496011257171631
global rounds: 1
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.6112
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7496
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.5798 train time 7.3292
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.5397 train time 7.3094
clientId: 0 current_loss: 0.5053874254226685 train_finish_times: [7.329249620437622, 7.309398412704468, 7.286939859390259]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.5054 train time 7.2869
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.6666734218597412 hit rate: 0.8005477786064148 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.6666734218597412 hit rate: 0.8005477786064148 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6666734218597412 hit rate: 0.8005477786064148
global rounds: 2
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.6667
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8005
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4756 train time 7.3032
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.4497 train time 7.2935
clientId: 0 current_loss: 0.4267745912075043 train_finish_times: [7.3031933307647705, 7.293485403060913, 7.307161808013916]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.4268 train time 7.3072
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.6881189346313477 hit rate: 0.8176186084747314 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.6881189346313477 hit rate: 0.8176186084747314 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.6881189346313477 hit rate: 0.8176186084747314
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.6881
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8176
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
global rounds: 3
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4061 train time 7.3485
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3874 train time 7.3580
clientId: 0 current_loss: 0.370053768157959 train_finish_times: [7.348487854003906, 7.358049154281616, 7.352189540863037]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3701 train time 7.3522
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.7010236382484436 hit rate: 0.8284141421318054 traveled user hit rate: 0.8913043737411499
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.7010236382484436 hit rate: 0.8284141421318054 traveled user hit rate: 0.8913043737411499

Predict Day 20 average auc score: 0.7010236382484436 hit rate: 0.8284141421318054
global rounds: 4
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.7010
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8284
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8913
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.3539 train time 7.4926
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3387 train time 7.4581
clientId: 0 current_loss: 0.3244093060493469 train_finish_times: [7.492639780044556, 7.458129644393921, 7.463415622711182]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3244 train time 7.4634
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.7106270790100098 hit rate: 0.837242066860199 traveled user hit rate: 0.8913043737411499
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.7106270790100098 hit rate: 0.837242066860199 traveled user hit rate: 0.8913043737411499

Predict Day 20 average auc score: 0.7106270790100098 hit rate: 0.837242066860199
global rounds: 5
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.7106
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8372
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8913
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.3109 train time 7.4341
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2982 train time 7.4475
clientId: 0 current_loss: 0.28631868958473206 train_finish_times: [7.43412709236145, 7.447474241256714, 7.44836950302124]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2863 train time 7.4484
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.7177661657333374 hit rate: 0.8427461981773376 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.7177661657333374 hit rate: 0.8427461981773376 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.7177661657333374 hit rate: 0.8427461981773376
global rounds: 6
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.7178
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8427
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2751 train time 7.4499
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2646 train time 7.4444
clientId: 0 current_loss: 0.25481775403022766 train_finish_times: [7.449895620346069, 7.444383144378662, 7.4497199058532715]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2548 train time 7.4497
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.722588837146759 hit rate: 0.846149742603302 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.722588837146759 hit rate: 0.846149742603302 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.722588837146759 hit rate: 0.846149742603302
global rounds: 7
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.7226
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8461
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2456 train time 7.4088
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2370 train time 7.4376
clientId: 0 current_loss: 0.22881853580474854 train_finish_times: [7.408768177032471, 7.437577247619629, 7.480039596557617]
[36m(Trainer pid=71462, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2288 train time 7.4800
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) auc score: 0.7260822653770447 hit rate: 0.8485428690910339 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 963fccf62700f418258f951330000000) final auc score: 0.7260822653770447 hit rate: 0.8485428690910339 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.7260822653770447 hit rate: 0.8485428690910339
training is not complete
//train_time: 244235.58299999998 ms//end
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test AUC: 0.7261
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8485
[36m(Trainer pid=71462, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
//Log Max memory for Large1: 10655125504.0 //end
//Log Max memory for Large2: 5865226240.0 //end
//Log Max memory for Large3: 5763596288.0 //end
//Log Max memory for Large4: 5930926080.0 //end
//Log Max memory for Server: 18521526272.0 //end
//Log Large1 network: 4488078653.0 //end
//Log Large2 network: 3695177.0 //end
//Log Large3 network: 3242753.0 //end
//Log Large4 network: 3208174.0 //end
//Log Server network: 2512426309.0 //end
//Log Total Actual Train Comm Cost: 6685.88 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 4760.96 MB //end
The whole process has ended

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: STFL, Countries: US, BR
--------------------------------------------------------------------------------

2025-05-15 00:38:08,898	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:38:08,899	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:38:08,908	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12217.337000000001 ms //end
//Log Large1 init network: 157790.0 //end
//Log Large2 init network: 174104.0 //end
//Log Large3 init network: 144751.0 //end
//Log Large4 init network: 151610.0 //end
//Log Server init network: 329067.0 //end
//Log Initialization Communication Cost (MB): 0.91 //end
Pretrain start time recorded.
//pretrain_time: 1119.067 ms//end
[36m(Trainer pid=72812, ip=192.168.42.57)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=72812, ip=192.168.42.57)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=72671, ip=192.168.39.156)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=72812, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=72671, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=72812, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=72812, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Device: 'cpu'
[36m(Trainer pid=72671, ip=192.168.39.156)[0m [Debug] Trainer running on node IP: 192.168.39.156
[36m(Trainer pid=72671, ip=192.168.39.156)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=72671, ip=192.168.39.156)[0m   return torch.load(io.BytesIO(b))
//Log Max memory for Large1: 6031712256.0 //end
//Log Max memory for Large2: 5859880960.0 //end
//Log Max memory for Large3: 6934437888.0 //end
//Log Max memory for Large4: 6884622336.0 //end
//Log Max memory for Server: 18487320576.0 //end
//Log Large1 network: 383040.0 //end
//Log Large2 network: 425824.0 //end
//Log Large3 network: 191460348.0 //end
//Log Large4 network: 191485005.0 //end
//Log Server network: 687333252.0 //end
//Log Total Actual Pretrain Comm Cost: 1021.47 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72671, ip=192.168.39.156)[0m loading train_data and test_data
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.7487 train time 5.1658
[36m(Trainer pid=72812, ip=192.168.42.57)[0m loading train_data and test_data
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.6424 train time 5.0258[32m [repeated 2x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 1 current_loss: 0.5601566433906555 train_finish_times: [5.165780305862427, 5.025821685791016, 5.102575302124023]
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.5602 train time 5.1026[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.649139940738678 train_finish_times: [7.440287828445435, 7.38692045211792, 7.364888668060303]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.6491 train time 7.3649
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.6972278952598572 hit rate: 0.8344672918319702 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.6972278952598572 hit rate: 0.8344672918319702 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.6972
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8345
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.6053141355514526 hit rate: 0.7385396957397461 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.6053141355514526 hit rate: 0.7385396957397461 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.6512709856033325 hit rate: 0.7865034937858582
global rounds: 1
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.5313 train time 5.0636
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.6053
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7385
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7609
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.4679 train time 5.0282[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.41461047530174255 train_finish_times: [5.063645839691162, 5.028241395950317, 5.1273274421691895]
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.4146 train time 5.1273[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.5191076397895813 train_finish_times: [7.342791557312012, 7.360843181610107, 7.355565786361694]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.5191 train time 7.3556
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.8039414882659912 hit rate: 0.9060416221618652 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.8039414882659912 hit rate: 0.9060416221618652 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8039
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9060
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.6596840023994446 hit rate: 0.7866411209106445 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.6596840023994446 hit rate: 0.7866411209106445 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.7318127155303955 hit rate: 0.8463413715362549
global rounds: 2
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.3858 train time 5.0692
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.6597
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7866
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7609
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 1 loss 0.4749 train time 7.3896[32m [repeated 3x across cluster][0m
clientId: 1 current_loss: 0.32045653462409973 train_finish_times: [5.069194555282593, 5.042558193206787, 5.0944132804870605]
clientId: 0 current_loss: 0.44994768500328064 train_finish_times: [7.431468963623047, 7.389641284942627, 7.3822221755981445]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.4499 train time 7.3822[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.8233823776245117 hit rate: 0.91958087682724 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.8233823776245117 hit rate: 0.91958087682724 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8234
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9196
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.6748502254486084 hit rate: 0.7999893426895142 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.6748502254486084 hit rate: 0.7999893426895142 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.7491163015365601 hit rate: 0.8597850799560547
global rounds: 3
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.3068 train time 5.0628
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.6749
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8000
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7609
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2822 train time 5.1143[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.2651640772819519 train_finish_times: [5.062826633453369, 5.114322662353516, 5.057142496109009]
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2652 train time 5.0571[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.4080426096916199 train_finish_times: [7.420489072799683, 7.407363414764404, 7.447563886642456]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.4080 train time 7.4476
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.830062747001648 hit rate: 0.9231187701225281 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.830062747001648 hit rate: 0.9231187701225281 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8301
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9231
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.685103178024292 hit rate: 0.8104658722877502 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.685103178024292 hit rate: 0.8104658722877502 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.75758296251297 hit rate: 0.8667923212051392
global rounds: 4
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2668 train time 5.0992
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.6851
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8105
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2452 train time 5.0894[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.23377712070941925 train_finish_times: [5.099209308624268, 5.089433193206787, 5.10200309753418]
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2338 train time 5.1020[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.3728683888912201 train_finish_times: [7.425219774246216, 7.418219804763794, 7.427421569824219]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3729 train time 7.4274
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.834907054901123 hit rate: 0.9252959489822388 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.834907054901123 hit rate: 0.9252959489822388 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8349
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9253
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.6932088136672974 hit rate: 0.817299485206604 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.6932088136672974 hit rate: 0.817299485206604 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.7640579342842102 hit rate: 0.8712977170944214
global rounds: 5
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2335 train time 5.0704
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.6932
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8173
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8261
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2178 train time 5.0678[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.21402372419834137 train_finish_times: [5.070398330688477, 5.067814826965332, 5.099314451217651]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 1 loss 0.3515 train time 7.6053
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2140 train time 5.0993
clientId: 0 current_loss: 0.339484304189682 train_finish_times: [7.57901406288147, 7.605311632156372, 7.626614093780518]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3395 train time 7.6266
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.8385665416717529 hit rate: 0.9269288182258606 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.8385665416717529 hit rate: 0.9269288182258606 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8386
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9269
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.7005096673965454 hit rate: 0.8250638246536255 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.7005096673965454 hit rate: 0.8250638246536255 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.7695381045341492 hit rate: 0.8759963512420654
global rounds: 6
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2098 train time 5.0868
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.7005
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8251
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8478
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.1985 train time 5.0466[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.19522307813167572 train_finish_times: [5.086825132369995, 5.046576976776123, 5.056556940078735]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 1 loss 0.3232 train time 7.6090
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.1952 train time 5.0566
clientId: 0 current_loss: 0.31610482931137085 train_finish_times: [7.573225736618042, 7.608998775482178, 7.562126398086548]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3161 train time 7.5621
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.8414802551269531 hit rate: 0.9293100833892822 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.8414802551269531 hit rate: 0.9293100833892822 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8415
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9293
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.7073671817779541 hit rate: 0.8310997486114502 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.7073671817779541 hit rate: 0.8310997486114502 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.7744237184524536 hit rate: 0.8802049160003662
global rounds: 7
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.1966 train time 5.0516
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.7074
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8311
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8478
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.1840 train time 5.0846[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.1798003762960434 train_finish_times: [5.051638603210449, 5.084625244140625, 5.086107969284058]
[36m(Trainer pid=72812, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.1798 train time 5.0861
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 1 loss 0.2983 train time 7.6010
clientId: 0 current_loss: 0.29438886046409607 train_finish_times: [7.596158266067505, 7.600977659225464, 7.671257019042969]
[36m(Trainer pid=72671, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.2944 train time 7.6713
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) auc score: 0.8436139822006226 hit rate: 0.9297863841056824 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 4f6c9de6f619580dd1aded3831000000) final auc score: 0.8436139822006226 hit rate: 0.9297863841056824 traveled user hit rate: 1.0

[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test AUC: 0.8436
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9298
[36m(Trainer pid=72812, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) auc score: 0.7123982906341553 hit rate: 0.8355934619903564 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b852f793e5b0e9bacafb87831000000) final auc score: 0.7123982906341553 hit rate: 0.8355934619903564 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.7780061364173889 hit rate: 0.8826899528503418
training is not complete
//train_time: 257679.61500000002 ms//end
//Log Max memory for Large1: 6034059264.0 //end
//Log Max memory for Large2: 5860466688.0 //end
//Log Max memory for Large3: 11131559936.0 //end
//Log Max memory for Large4: 10880131072.0 //end
//Log Max memory for Server: 18757468160.0 //end
//Log Large1 network: 3382937.0 //end
//Log Large2 network: 3863080.0 //end
//Log Large3 network: 4603425498.0 //end
//Log Large4 network: 4565764197.0 //end
//Log Server network: 5014292269.0 //end
//Log Total Actual Train Comm Cost: 13533.33 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 9521.92 MB //end
The whole process has ended
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test AUC: 0.7124
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8356
[36m(Trainer pid=72671, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8478

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: STFL, Countries: US, BR, ID, TR, JP
--------------------------------------------------------------------------------

2025-05-15 00:43:45,172	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:43:45,172	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:43:45,181	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12725.218 ms //end
//Log Large1 init network: 194898.0 //end
//Log Large2 init network: 174630.0 //end
//Log Large3 init network: 158562.0 //end
//Log Large4 init network: 158521.0 //end
//Log Server init network: 282563.0 //end
//Log Initialization Communication Cost (MB): 0.92 //end
Pretrain start time recorded.
//pretrain_time: 2768.475 ms//end
[36m(Trainer pid=78213, ip=192.168.14.62)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=78213, ip=192.168.14.62)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=74324, ip=192.168.14.54)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=74324, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=74303, ip=192.168.42.57)[0m checking code and file path: TR,data/LPDataset
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_TR.txt
[36m(Trainer pid=78218, ip=192.168.14.62)[0m checking code and file path: JP,data/LPDataset
[36m(Trainer pid=78218, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_JP.txt
[36m(Trainer pid=74166, ip=192.168.39.156)[0m checking code and file path: ID,data/LPDataset
[36m(Trainer pid=74166, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_ID.txt
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=74303, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=74166, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74303, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=74303, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Device: 'cpu'[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m [Debug] Trainer running on node IP: 192.168.14.62[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m   return torch.load(io.BytesIO(b))[32m [repeated 4x across cluster][0m
//Log Max memory for Large1: 7011753984.0 //end
//Log Max memory for Large2: 8054673408.0 //end
//Log Max memory for Large3: 6688423936.0 //end
//Log Max memory for Large4: 6818582528.0 //end
//Log Max memory for Server: 18458251264.0 //end
//Log Large1 network: 191353121.0 //end
//Log Large2 network: 382882760.0 //end
//Log Large3 network: 191444474.0 //end
//Log Large4 network: 191727886.0 //end
//Log Server network: 1717625565.0 //end
//Log Total Actual Pretrain Comm Cost: 2551.11 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74303, ip=192.168.42.57)[0m loading train_data and test_data
[36m(Trainer pid=78218, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.7754 train time 4.1406
[36m(Trainer pid=74324, ip=192.168.14.54)[0m loading train_data and test_data[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.6750 train time 4.6832[32m [repeated 7x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 4 current_loss: 0.5672926306724548 train_finish_times: [4.140624284744263, 4.063059091567993, 4.049174547195435]
clientId: 3 current_loss: 0.5519247651100159 train_finish_times: [4.281901121139526, 4.163733720779419, 4.139178991317749]
clientId: 2 current_loss: 0.586158037185669 train_finish_times: [4.812232732772827, 4.683231592178345, 4.7248618602752686]
clientId: 1 current_loss: 0.589280366897583 train_finish_times: [5.100665092468262, 5.064069747924805, 5.072445392608643]
[36m(Trainer pid=74324, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.5893 train time 5.0724[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.6861517429351807 train_finish_times: [7.45271635055542, 8.329150199890137, 7.476253271102905]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.6862 train time 7.4763[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.7678359746932983 hit rate: 0.8967386484146118 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.7678359746932983 hit rate: 0.8967386484146118 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.7678
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8967
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.6979657411575317 hit rate: 0.8316773176193237 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.6979657411575317 hit rate: 0.8316773176193237 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.6940193176269531 hit rate: 0.8337869048118591 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.6940193176269531 hit rate: 0.8337869048118591 traveled user hit rate: 0.800000011920929

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.6850276589393616 hit rate: 0.8211308121681213 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.6850276589393616 hit rate: 0.8211308121681213 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.598324179649353 hit rate: 0.7314135432243347 traveled user hit rate: 0.6086956262588501
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.598324179649353 hit rate: 0.7314135432243347 traveled user hit rate: 0.6086956262588501

Predict Day 20 average auc score: 0.6886345744132996 hit rate: 0.8229494094848633
global rounds: 1
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78218, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.5298 train time 4.0711
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.5983[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7314[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.6087[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.4843 train time 4.6336[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.41446295380592346 train_finish_times: [4.071115732192993, 4.14313268661499, 4.097502946853638]
clientId: 3 current_loss: 0.3961371183395386 train_finish_times: [4.133464336395264, 4.153912782669067, 4.132146596908569]
clientId: 2 current_loss: 0.43238145112991333 train_finish_times: [4.628364562988281, 4.633625030517578, 4.669196844100952]
clientId: 1 current_loss: 0.44019371271133423 train_finish_times: [5.064134359359741, 5.065448522567749, 5.069176197052002]
[36m(Trainer pid=74324, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.4402 train time 5.0692[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.54465651512146 train_finish_times: [7.639169216156006, 7.608003616333008, 7.488036155700684]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.5447 train time 7.4880[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.8828048706054688 hit rate: 0.958609402179718 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.8828048706054688 hit rate: 0.958609402179718 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.8828
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9586
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.7921632528305054 hit rate: 0.8982729911804199 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.7921632528305054 hit rate: 0.8982729911804199 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.7960427403450012 hit rate: 0.9052252173423767 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.7960427403450012 hit rate: 0.9052252173423767 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.7768359184265137 hit rate: 0.8865196108818054 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.7768359184265137 hit rate: 0.8865196108818054 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6491634845733643 hit rate: 0.7767761945724487 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6491634845733643 hit rate: 0.7767761945724487 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7794020771980286 hit rate: 0.8850806951522827
global rounds: 2
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78218, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.3818 train time 4.1097
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6492[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7768[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8043[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.3570 train time 4.6553[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.2938140332698822 train_finish_times: [4.109717130661011, 4.179550647735596, 4.0750815868377686]
clientId: 3 current_loss: 0.2662881314754486 train_finish_times: [4.182888984680176, 4.15875244140625, 4.145445346832275]
clientId: 2 current_loss: 0.3265276253223419 train_finish_times: [4.6445698738098145, 4.655292510986328, 4.6422929763793945]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.4988 train time 7.5385[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.3352104127407074 train_finish_times: [5.086907386779785, 5.085922956466675, 5.091606855392456]
clientId: 0 current_loss: 0.47489693760871887 train_finish_times: [7.556727886199951, 7.538539171218872, 7.5519490242004395]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4749 train time 7.5519[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.9082173109054565 hit rate: 0.9673866033554077 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.9082173109054565 hit rate: 0.9673866033554077 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.9082
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9674
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.8152984976768494 hit rate: 0.904778778553009 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.8152984976768494 hit rate: 0.904778778553009 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.8212913274765015 hit rate: 0.918492317199707 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.8212913274765015 hit rate: 0.918492317199707 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.7982252240180969 hit rate: 0.8984290957450867 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.7982252240180969 hit rate: 0.8984290957450867 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6630719900131226 hit rate: 0.7870399951934814 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6630719900131226 hit rate: 0.7870399951934814 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.8012207746505737 hit rate: 0.8952253460884094
global rounds: 3
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78218, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.2735 train time 4.1144
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6631[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7870[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7609[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2924 train time 4.6719[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.22946204245090485 train_finish_times: [4.1144092082977295, 4.164512395858765, 4.149669885635376]
clientId: 3 current_loss: 0.19155271351337433 train_finish_times: [4.154629468917847, 4.139906167984009, 4.151294469833374]
clientId: 2 current_loss: 0.27700796723365784 train_finish_times: [4.661667823791504, 4.671867370605469, 4.6610167026519775]
clientId: 1 current_loss: 0.28494617342948914 train_finish_times: [5.060330390930176, 5.097738742828369, 5.071264028549194]
[36m(Trainer pid=74324, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.2849 train time 5.0713[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.43832719326019287 train_finish_times: [7.679652690887451, 8.416939496994019, 7.323302268981934]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4383 train time 7.3233[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.9121136665344238 hit rate: 0.9686774015426636 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.9121136665344238 hit rate: 0.9686774015426636 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.9121
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9687
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.8189688324928284 hit rate: 0.9071445465087891 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.8189688324928284 hit rate: 0.9071445465087891 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.826521635055542 hit rate: 0.9203973412513733 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.826521635055542 hit rate: 0.9203973412513733 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.8030803203582764 hit rate: 0.9009811282157898 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.8030803203582764 hit rate: 0.9009811282157898 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6699703931808472 hit rate: 0.7942724823951721 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6699703931808472 hit rate: 0.7942724823951721 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.8061310052871704 hit rate: 0.8982946276664734
global rounds: 4
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74303, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1856 train time 4.1728
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6700[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7943[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7609[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2553 train time 4.6868[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.19277314841747284 train_finish_times: [4.193910121917725, 4.199944496154785, 4.096018314361572]
clientId: 3 current_loss: 0.15195757150650024 train_finish_times: [4.172787189483643, 4.162828683853149, 4.164287567138672]
clientId: 2 current_loss: 0.2440013587474823 train_finish_times: [4.653149843215942, 4.686795234680176, 4.698443174362183]
clientId: 1 current_loss: 0.25136005878448486 train_finish_times: [5.074915885925293, 5.06746244430542, 5.105224370956421]
[36m(Trainer pid=74324, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.2514 train time 5.1052[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.41517579555511475 train_finish_times: [7.755567312240601, 7.686197519302368, 8.453101634979248]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4152 train time 8.4531[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.9140522480010986 hit rate: 0.9689355492591858 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.9140522480010986 hit rate: 0.9689355492591858 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.9141
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9689
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.8300416469573975 hit rate: 0.9216219782829285 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.8300416469573975 hit rate: 0.9216219782829285 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.8208858966827393 hit rate: 0.9093919992446899 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.8208858966827393 hit rate: 0.9093919992446899 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.8067632913589478 hit rate: 0.9031928777694702 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.8067632913589478 hit rate: 0.9031928777694702 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6777610778808594 hit rate: 0.8030738234519958 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6777610778808594 hit rate: 0.8030738234519958 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.8099008798599243 hit rate: 0.9012433290481567
global rounds: 5
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74303, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1633 train time 4.1513
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6778[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8031[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8043[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2332 train time 4.6929[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.17372947931289673 train_finish_times: [4.112016201019287, 4.19777774810791, 4.0909669399261475]
clientId: 3 current_loss: 0.13308534026145935 train_finish_times: [4.15125298500061, 4.1897032260894775, 4.15824556350708]
clientId: 2 current_loss: 0.22766833007335663 train_finish_times: [4.7164881229400635, 4.692883014678955, 4.719056844711304]
clientId: 1 current_loss: 0.23417095839977264 train_finish_times: [5.0569775104522705, 5.0242085456848145, 5.086384296417236]
[36m(Trainer pid=74324, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.2342 train time 5.0864[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.41014230251312256 train_finish_times: [7.809468746185303, 7.4471495151519775, 7.563750982284546]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4101 train time 7.5638[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.915519654750824 hit rate: 0.9697960615158081 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.915519654750824 hit rate: 0.9697960615158081 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.9155
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9698
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.8225679397583008 hit rate: 0.9130589365959167 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.8225679397583008 hit rate: 0.9130589365959167 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.8329630494117737 hit rate: 0.9225064516067505 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.8329630494117737 hit rate: 0.9225064516067505 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.8096954822540283 hit rate: 0.903930127620697 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.8096954822540283 hit rate: 0.903930127620697 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6847612857818604 hit rate: 0.8088172674179077 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6847612857818604 hit rate: 0.8088172674179077 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.8131014704704285 hit rate: 0.9036217927932739
global rounds: 6
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=74303, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1508 train time 4.1367
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6848[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8088[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8261[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2180 train time 4.6678[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.12328395992517471 train_finish_times: [4.136653661727905, 4.149444580078125, 4.181335687637329]
clientId: 4 current_loss: 0.16293582320213318 train_finish_times: [4.372084856033325, 4.264658212661743, 4.113779306411743]
clientId: 2 current_loss: 0.21176135540008545 train_finish_times: [4.691782712936401, 4.667821884155273, 4.686280727386475]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3888 train time 7.4281[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.21875755488872528 train_finish_times: [5.087944746017456, 5.085219621658325, 5.099416255950928]
clientId: 0 current_loss: 0.3846665322780609 train_finish_times: [7.636772394180298, 7.428055047988892, 7.35047459602356]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.3847 train time 7.3505[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.9165000915527344 hit rate: 0.970140278339386 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.9165000915527344 hit rate: 0.970140278339386 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.9165
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9701
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.8239127397537231 hit rate: 0.9130589365959167 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.8239127397537231 hit rate: 0.9130589365959167 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.835224449634552 hit rate: 0.9241393208503723 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.835224449634552 hit rate: 0.9241393208503723 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.8117383122444153 hit rate: 0.9046673774719238 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.8117383122444153 hit rate: 0.9046673774719238 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6903444528579712 hit rate: 0.8157041072845459 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6903444528579712 hit rate: 0.8157041072845459 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.8155440092086792 hit rate: 0.9055420160293579
global rounds: 7
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78218, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.1651 train time 4.1593
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6903[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8157[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8261[32m [repeated 4x across cluster][0m
[36m(Trainer pid=74166, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2060 train time 4.6881[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.15632237493991852 train_finish_times: [4.159334182739258, 4.216212511062622, 4.124326944351196]
clientId: 3 current_loss: 0.11856379359960556 train_finish_times: [4.176093816757202, 4.194032907485962, 4.183157920837402]
clientId: 2 current_loss: 0.19950291514396667 train_finish_times: [4.700328588485718, 4.688114404678345, 4.706294536590576]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3767 train time 7.7055[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.20686691999435425 train_finish_times: [5.049557447433472, 5.0747950077056885, 5.080213308334351]
clientId: 0 current_loss: 0.3581692576408386 train_finish_times: [7.403423309326172, 7.70549464225769, 7.370021104812622]
[36m(Trainer pid=78213, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.3582 train time 7.3700[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) auc score: 0.9172642827033997 hit rate: 0.9700542092323303 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 53434122ed04d2adf443872a32000000) final auc score: 0.9172642827033997 hit rate: 0.9700542092323303 traveled user hit rate: 1.0

[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test AUC: 0.9173
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9701
[36m(Trainer pid=74303, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) auc score: 0.825081467628479 hit rate: 0.9145966172218323 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d88fef38483de28b5f372afb32000000) final auc score: 0.825081467628479 hit rate: 0.9145966172218323 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) auc score: 0.8372998237609863 hit rate: 0.9237311482429504 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 6ff687fe7e657da30474288e32000000) final auc score: 0.8372998237609863 hit rate: 0.9237311482429504 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) auc score: 0.813664972782135 hit rate: 0.9058583378791809 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 8aafae333507650bf2a3de3c32000000) final auc score: 0.813664972782135 hit rate: 0.9058583378791809 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) auc score: 0.6958163976669312 hit rate: 0.8216602802276611 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 1b594271d59de6bae0fe13cd32000000) final auc score: 0.6958163976669312 hit rate: 0.8216602802276611 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.817825436592102 hit rate: 0.90718013048172
training is not complete
//train_time: 298018.986 ms//end
//Log Max memory for Large1: 9772396544.0 //end
//Log Max memory for Large2: 13715542016.0 //end
//Log Max memory for Large3: 9789243392.0 //end
//Log Max memory for Large4: 9806012416.0 //end
//Log Max memory for Server: 19908145152.0 //end
//Log Large1 network: 4823362760.0 //end
//Log Large2 network: 9680419260.0 //end
//Log Large3 network: 4854101273.0 //end
//Log Large4 network: 4842444526.0 //end
//Log Server network: 12527866792.0 //end
//Log Total Actual Train Comm Cost: 35026.74 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 23804.80 MB //end
The whole process has ended
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test AUC: 0.6958[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8217[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78213, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8261[32m [repeated 4x across cluster][0m

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: StaticGNN, Countries: US
--------------------------------------------------------------------------------

2025-05-15 00:50:04,067	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:50:04,069	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:50:04,078	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12298.069 ms //end
//Log Large1 init network: 156510.0 //end
//Log Large2 init network: 184847.0 //end
//Log Large3 init network: 157725.0 //end
//Log Large4 init network: 157403.0 //end
//Log Server init network: 351799.0 //end
//Log Initialization Communication Cost (MB): 0.96 //end
Pretrain start time recorded.
//pretrain_time: 615.972 ms//end
[36m(Trainer pid=75997, ip=192.168.14.54)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=75997, ip=192.168.14.54)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Device: 'cpu'
[36m(Trainer pid=75997, ip=192.168.14.54)[0m [Debug] Trainer running on node IP: 192.168.14.54
[36m(Trainer pid=75997, ip=192.168.14.54)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=75997, ip=192.168.14.54)[0m   return torch.load(io.BytesIO(b))
//Log Max memory for Large1: 7379177472.0 //end
//Log Max memory for Large2: 5980831744.0 //end
//Log Max memory for Large3: 5698248704.0 //end
//Log Max memory for Large4: 6031749120.0 //end
//Log Max memory for Server: 18433368064.0 //end
//Log Large1 network: 153185414.0 //end
//Log Large2 network: 410597.0 //end
//Log Large3 network: 377005.0 //end
//Log Large4 network: 342451.0 //end
//Log Server network: 344221660.0 //end
//Log Total Actual Pretrain Comm Cost: 475.44 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m loading train_data and test_data
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.7875 train time 7.3043
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.7100 train time 7.1987
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 0 current_loss: 0.6569448709487915 train_finish_times: [7.30428409576416, 7.198720216751099, 7.216429710388184]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.6569 train time 7.2164
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.5765488147735596 hit rate: 0.7108594179153442 traveled user hit rate: 0.8913043737411499
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.5765488147735596 hit rate: 0.7108594179153442 traveled user hit rate: 0.8913043737411499

Predict Day 20 average auc score: 0.5765488147735596 hit rate: 0.7108594179153442
global rounds: 1
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.5765
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7109
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8913
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.6099 train time 7.2241
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.5665 train time 7.2174
clientId: 0 current_loss: 0.5292461514472961 train_finish_times: [7.224116086959839, 7.21735405921936, 7.229773998260498]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.5292 train time 7.2298
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.6557251811027527 hit rate: 0.7877047657966614 traveled user hit rate: 0.8913043737411499
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.6557251811027527 hit rate: 0.7877047657966614 traveled user hit rate: 0.8913043737411499

Predict Day 20 average auc score: 0.6557251811027527 hit rate: 0.7877047657966614
global rounds: 2
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.6557
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7877
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8913
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4985 train time 7.1391
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.4716 train time 7.2384
clientId: 0 current_loss: 0.44635680317878723 train_finish_times: [7.139147043228149, 7.23838996887207, 7.166110515594482]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.4464 train time 7.1661
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.6823412179946899 hit rate: 0.8121410608291626 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.6823412179946899 hit rate: 0.8121410608291626 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.6823412179946899 hit rate: 0.8121410608291626
global rounds: 3
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.6823
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8121
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4229 train time 7.2200
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.4025 train time 7.2383
clientId: 0 current_loss: 0.3849044144153595 train_finish_times: [7.219999074935913, 7.238260746002197, 7.184757709503174]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3849 train time 7.1848
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.6963497400283813 hit rate: 0.8237609267234802 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.6963497400283813 hit rate: 0.8237609267234802 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.6963497400283813 hit rate: 0.8237609267234802
global rounds: 4
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.6963
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8238
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8478
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.3685 train time 7.1483
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3525 train time 7.2434
clientId: 0 current_loss: 0.3378365635871887 train_finish_times: [7.148346185684204, 7.243427276611328, 7.156769037246704]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3378 train time 7.1568
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.7057098150253296 hit rate: 0.8309934139251709 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.7057098150253296 hit rate: 0.8309934139251709 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7057098150253296 hit rate: 0.8309934139251709
global rounds: 5
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.7057
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8310
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.3249 train time 7.2698
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3125 train time 7.2096
clientId: 0 current_loss: 0.30019375681877136 train_finish_times: [7.269769668579102, 7.209579706192017, 7.236599922180176]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3002 train time 7.2366
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.7137574553489685 hit rate: 0.8383322954177856 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.7137574553489685 hit rate: 0.8383322954177856 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7137574553489685 hit rate: 0.8383322954177856
global rounds: 6
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.7138
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8383
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2888 train time 7.1884
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2787 train time 7.2416
clientId: 0 current_loss: 0.26891767978668213 train_finish_times: [7.188375473022461, 7.241621017456055, 7.2335357666015625]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2689 train time 7.2335
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.7195
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8432
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8043
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.7195385694503784 hit rate: 0.8431982398033142 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.7195385694503784 hit rate: 0.8431982398033142 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7195385694503784 hit rate: 0.8431982398033142
global rounds: 7
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2593 train time 7.2008
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2506 train time 7.2387
clientId: 0 current_loss: 0.2427167445421219 train_finish_times: [7.2008373737335205, 7.238720893859863, 7.244167327880859]
[36m(Trainer pid=75997, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2427 train time 7.2442
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) auc score: 0.7232595682144165 hit rate: 0.8458040952682495 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a8aed0e69bc44138b5de1d2f33000000) final auc score: 0.7232595682144165 hit rate: 0.8458040952682495 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.7232595682144165 hit rate: 0.8458040952682495
training is not complete
//train_time: 220193.609 ms//end
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test AUC: 0.7233
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8458
[36m(Trainer pid=75997, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8261
//Log Max memory for Large1: 11960201216.0 //end
//Log Max memory for Large2: 5956583424.0 //end
//Log Max memory for Large3: 5700329472.0 //end
//Log Max memory for Large4: 6004260864.0 //end
//Log Max memory for Server: 18428534784.0 //end
//Log Large1 network: 1833973159.0 //end
//Log Large2 network: 3422632.0 //end
//Log Large3 network: 2935868.0 //end
//Log Large4 network: 2963049.0 //end
//Log Server network: 10104594.0 //end
//Log Total Actual Train Comm Cost: 1767.54 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 0.00 MB //end
The whole process has ended

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: StaticGNN, Countries: US, BR
--------------------------------------------------------------------------------

2025-05-15 00:55:02,485	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:55:02,486	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:55:02,493	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12520.456 ms //end
//Log Large1 init network: 157310.0 //end
//Log Large2 init network: 137785.0 //end
//Log Large3 init network: 151699.0 //end
//Log Large4 init network: 151630.0 //end
//Log Server init network: 387681.0 //end
//Log Initialization Communication Cost (MB): 0.94 //end
Pretrain start time recorded.
//pretrain_time: 1117.5600000000002 ms//end
[36m(Trainer pid=77238, ip=192.168.42.57)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=77238, ip=192.168.42.57)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=77097, ip=192.168.39.156)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=77238, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=77097, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=77238, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=77238, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Device: 'cpu'
[36m(Trainer pid=77097, ip=192.168.39.156)[0m [Debug] Trainer running on node IP: 192.168.39.156
[36m(Trainer pid=77097, ip=192.168.39.156)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=77097, ip=192.168.39.156)[0m   return torch.load(io.BytesIO(b))
//Log Max memory for Large1: 6160191488.0 //end
//Log Max memory for Large2: 5924110336.0 //end
//Log Max memory for Large3: 6921981952.0 //end
//Log Max memory for Large4: 6938329088.0 //end
//Log Max memory for Server: 18529062912.0 //end
//Log Large1 network: 374467.0 //end
//Log Large2 network: 425191.0 //end
//Log Large3 network: 191445902.0 //end
//Log Large4 network: 153391933.0 //end
//Log Server network: 687987902.0 //end
//Log Total Actual Pretrain Comm Cost: 985.74 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m loading train_data and test_data
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.8016 train time 5.1461
[36m(Trainer pid=77097, ip=192.168.39.156)[0m loading train_data and test_data
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.6878 train time 5.0611[32m [repeated 2x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 1 current_loss: 0.5989168286323547 train_finish_times: [5.1461286544799805, 5.0611252784729, 5.064636468887329]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.5989 train time 5.0646[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.6758615970611572 train_finish_times: [7.457380771636963, 7.344843149185181, 7.307060956954956]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.6759 train time 7.3071
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.7201066613197327 hit rate: 0.8580759167671204 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.7201066613197327 hit rate: 0.8580759167671204 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.7201
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8581
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.574886679649353 hit rate: 0.7125877737998962 traveled user hit rate: 0.6086956262588501
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.574886679649353 hit rate: 0.7125877737998962 traveled user hit rate: 0.6086956262588501

Predict Day 20 average auc score: 0.6474967002868652 hit rate: 0.7853318452835083
global rounds: 1
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.5254 train time 5.0991
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.5749
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7126
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.6087
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.4631 train time 5.0415[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.4112752079963684 train_finish_times: [5.099090814590454, 5.041485786437988, 5.054747819900513]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.4113 train time 5.0547[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.5384001731872559 train_finish_times: [7.351629257202148, 7.335634469985962, 7.367245435714722]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.5384 train time 7.3672
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.812594473361969 hit rate: 0.9145461916923523 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.812594473361969 hit rate: 0.9145461916923523 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8126
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9145
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.6553531885147095 hit rate: 0.78922039270401 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.6553531885147095 hit rate: 0.78922039270401 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.7339738607406616 hit rate: 0.8518832921981812
global rounds: 2
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.3697 train time 5.0553
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.6554
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7892
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.3373 train time 4.9773[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.31202706694602966 train_finish_times: [5.055296182632446, 4.977271318435669, 5.109927177429199]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.3120 train time 5.1099[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.45778557658195496 train_finish_times: [7.3738157749176025, 7.407187461853027, 7.367844104766846]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.4578 train time 7.3678
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.8267495036125183 hit rate: 0.9206694960594177 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.8267495036125183 hit rate: 0.9206694960594177 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8267
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9207
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.6798254251480103 hit rate: 0.8093224763870239 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.6798254251480103 hit rate: 0.8093224763870239 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7532874345779419 hit rate: 0.8649959564208984
global rounds: 3
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2923 train time 5.0918
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.6798
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8093
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2770 train time 5.0909[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.26506975293159485 train_finish_times: [5.091753959655762, 5.090912103652954, 5.103759527206421]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2651 train time 5.1038[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.4009426236152649 train_finish_times: [7.368927001953125, 7.358898878097534, 7.338193655014038]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.4009 train time 7.3382
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.8317242860794067 hit rate: 0.9236630797386169 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.8317242860794067 hit rate: 0.9236630797386169 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8317
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9237
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.6942731142044067 hit rate: 0.8223516345024109 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.6942731142044067 hit rate: 0.8223516345024109 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.7629987001419067 hit rate: 0.8730073571205139
global rounds: 4
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2556 train time 5.1080
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.6943
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8224
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8261
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2473 train time 5.1069[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.23950117826461792 train_finish_times: [5.107978582382202, 5.1068947315216064, 5.119649648666382]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2395 train time 5.1196[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.35437458753585815 train_finish_times: [7.2590484619140625, 7.2779700756073, 7.245439767837524]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3544 train time 7.2454
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.8356403112411499 hit rate: 0.9262484908103943 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.8356403112411499 hit rate: 0.9262484908103943 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8356
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9262
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.7041030526161194 hit rate: 0.8309668302536011 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.7041030526161194 hit rate: 0.8309668302536011 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.769871711730957 hit rate: 0.8786076307296753
global rounds: 5
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2321 train time 5.1126
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.7041
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8310
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2252 train time 5.1123[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.21857430040836334 train_finish_times: [5.1125993728637695, 5.1123206615448, 5.1324968338012695]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2186 train time 5.1325[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.31633901596069336 train_finish_times: [7.293230056762695, 7.255454778671265, 7.27683162689209]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3163 train time 7.2768
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.8389934301376343 hit rate: 0.9270648956298828 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.8389934301376343 hit rate: 0.9270648956298828 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8390
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9271
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.7131906747817993 hit rate: 0.839502215385437 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.7131906747817993 hit rate: 0.839502215385437 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7760920524597168 hit rate: 0.8832835555076599
global rounds: 6
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2122 train time 5.0906
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.7132
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8395
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2061 train time 5.0792[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.20056764781475067 train_finish_times: [5.0905821323394775, 5.079169034957886, 5.070866584777832]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2006 train time 5.0709[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.2852313220500946 train_finish_times: [7.224534749984741, 7.281692981719971, 7.206584215164185]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.2852 train time 7.2066
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8418
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9294
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.841830849647522 hit rate: 0.9293781518936157 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.841830849647522 hit rate: 0.9293781518936157 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.7192130088806152 hit rate: 0.8436502814292908 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.7192130088806152 hit rate: 0.8436502814292908 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7805219292640686 hit rate: 0.8865141868591309
global rounds: 7
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.1953 train time 5.1111
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.7192
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8437
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.1903 train time 5.0558[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.18537573516368866 train_finish_times: [5.111055612564087, 5.05580472946167, 5.078607797622681]
[36m(Trainer pid=77238, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.1854 train time 5.0786[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.25860655307769775 train_finish_times: [7.259708642959595, 7.25571608543396, 7.318022727966309]
[36m(Trainer pid=77097, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.2586 train time 7.3180
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) auc score: 0.8439521789550781 hit rate: 0.9297863841056824 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b32efa4be8510f496ecb66fa34000000) final auc score: 0.8439521789550781 hit rate: 0.9297863841056824 traveled user hit rate: 1.0

[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test AUC: 0.8440
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9298
[36m(Trainer pid=77238, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) auc score: 0.7231662273406982 hit rate: 0.8454850316047668 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, a4646e2eed0f8a6fac70ac8334000000) final auc score: 0.7231662273406982 hit rate: 0.8454850316047668 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7835592031478882 hit rate: 0.8876357078552246
training is not complete
//train_time: 218225.333 ms//end
//Log Max memory for Large1: 6161543168.0 //end
//Log Max memory for Large2: 5923958784.0 //end
//Log Max memory for Large3: 11255685120.0 //end
//Log Max memory for Large4: 10567507968.0 //end
//Log Max memory for Server: 18544586752.0 //end
//Log Large1 network: 2918804.0 //end
//Log Large2 network: 3301221.0 //end
//Log Large3 network: 1795875971.0 //end
//Log Large4 network: 1834017051.0 //end
//Log Server network: 8586288.0 //end
//Log Total Actual Train Comm Cost: 3475.86 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 0.00 MB //end
The whole process has ended
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test AUC: 0.7232
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8455
[36m(Trainer pid=77097, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: StaticGNN, Countries: US, BR, ID, TR, JP
--------------------------------------------------------------------------------

2025-05-15 00:59:59,537	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 00:59:59,537	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 00:59:59,544	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12601.384 ms //end
//Log Large1 init network: 123947.0 //end
//Log Large2 init network: 174914.0 //end
//Log Large3 init network: 123523.0 //end
//Log Large4 init network: 157602.0 //end
//Log Server init network: 422980.0 //end
//Log Initialization Communication Cost (MB): 0.96 //end
Pretrain start time recorded.
//pretrain_time: 2835.659 ms//end
[36m(Trainer pid=78591, ip=192.168.14.54)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=78591, ip=192.168.14.54)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=78591, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=82479, ip=192.168.14.62)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=78571, ip=192.168.42.57)[0m checking code and file path: TR,data/LPDataset
[36m(Trainer pid=78571, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_TR.txt
[36m(Trainer pid=82484, ip=192.168.14.62)[0m checking code and file path: JP,data/LPDataset
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_JP.txt
[36m(Trainer pid=78427, ip=192.168.39.156)[0m checking code and file path: ID,data/LPDataset
[36m(Trainer pid=78427, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_ID.txt
[36m(Trainer pid=78571, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=78571, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=78427, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78571, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=78571, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Device: 'cpu'[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m [Debug] Trainer running on node IP: 192.168.14.62[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m   return torch.load(io.BytesIO(b))[32m [repeated 4x across cluster][0m
//Log Max memory for Large1: 7015358464.0 //end
//Log Max memory for Large2: 8037908480.0 //end
//Log Max memory for Large3: 6671745024.0 //end
//Log Max memory for Large4: 7044800512.0 //end
//Log Max memory for Server: 18479751168.0 //end
//Log Large1 network: 191469421.0 //end
//Log Large2 network: 382809204.0 //end
//Log Large3 network: 191479784.0 //end
//Log Large4 network: 191660557.0 //end
//Log Server network: 1717136763.0 //end
//Log Total Actual Pretrain Comm Cost: 2550.66 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m loading train_data and test_data
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.7826 train time 4.2843
[36m(Trainer pid=82484, ip=192.168.14.62)[0m loading train_data and test_data[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.6810 train time 4.6390[32m [repeated 7x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 3 current_loss: 0.5454119443893433 train_finish_times: [4.284271478652954, 4.133729934692383, 4.128620386123657]
clientId: 4 current_loss: 0.5644024014472961 train_finish_times: [4.234050512313843, 4.130744695663452, 4.351383209228516]
clientId: 2 current_loss: 0.5890823006629944 train_finish_times: [4.699474334716797, 4.6390063762664795, 4.633177995681763]
clientId: 1 current_loss: 0.5883435010910034 train_finish_times: [4.968600511550903, 5.056882381439209, 5.026952743530273]
[36m(Trainer pid=78591, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.5883 train time 5.0270[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.7194899916648865 train_finish_times: [7.395871162414551, 7.514863729476929, 7.3885657787323]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.7195 train time 7.3886[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.7322590351104736 hit rate: 0.8625502586364746 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.7322590351104736 hit rate: 0.8625502586364746 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.7323
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8626
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.814957857131958 hit rate: 0.9309870004653931 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.814957857131958 hit rate: 0.9309870004653931 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.7184399366378784 hit rate: 0.8578718304634094 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.7184399366378784 hit rate: 0.8578718304634094 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.7060401439666748 hit rate: 0.8446095585823059 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.7060401439666748 hit rate: 0.8446095585823059 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.5374871492385864 hit rate: 0.6681557297706604 traveled user hit rate: 0.5869565010070801
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.5374871492385864 hit rate: 0.6681557297706604 traveled user hit rate: 0.5869565010070801

Predict Day 20 average auc score: 0.701836884021759 hit rate: 0.8328348994255066
global rounds: 1
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.4688 train time 4.1282
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.5375[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.6682[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.5870[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.4640 train time 4.6432[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.3465951681137085 train_finish_times: [4.128223180770874, 4.1284191608428955, 4.129567384719849]
clientId: 4 current_loss: 0.37603282928466797 train_finish_times: [4.315393924713135, 4.414554834365845, 4.077536106109619]
clientId: 2 current_loss: 0.4132823050022125 train_finish_times: [4.630188465118408, 4.643152475357056, 4.643966436386108]
clientId: 1 current_loss: 0.41748929023742676 train_finish_times: [5.050541639328003, 5.034122943878174, 5.021676301956177]
[36m(Trainer pid=78591, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.4175 train time 5.0217[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.5852318406105042 train_finish_times: [7.681342840194702, 7.619431734085083, 8.439008474349976]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.5852 train time 8.4390[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.8052760362625122 hit rate: 0.9053702354431152 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.8052760362625122 hit rate: 0.9053702354431152 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.8053
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9054
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.8972572088241577 hit rate: 0.9656655788421631 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.8972572088241577 hit rate: 0.9656655788421631 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.8038567304611206 hit rate: 0.9085589647293091 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.8038567304611206 hit rate: 0.9085589647293091 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.7852516174316406 hit rate: 0.8928713202476501 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.7852516174316406 hit rate: 0.8928713202476501 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.6288501620292664 hit rate: 0.7624441385269165 traveled user hit rate: 0.6521739363670349
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.6288501620292664 hit rate: 0.7624441385269165 traveled user hit rate: 0.6521739363670349

Predict Day 20 average auc score: 0.7840983867645264 hit rate: 0.8869820833206177
global rounds: 2
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.2952 train time 4.1156
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.6289[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7624[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.6522[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.3405 train time 4.6383[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.22171251475811005 train_finish_times: [4.115555286407471, 4.119690895080566, 4.130918025970459]
clientId: 4 current_loss: 0.267007976770401 train_finish_times: [4.1048948764801025, 4.3840672969818115, 4.36609959602356]
clientId: 2 current_loss: 0.3188447654247284 train_finish_times: [4.625959396362305, 4.638322353363037, 4.6279826164245605]
clientId: 1 current_loss: 0.32470396161079407 train_finish_times: [5.038954973220825, 5.02893853187561, 5.053501129150391]
[36m(Trainer pid=78591, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.3247 train time 5.0535[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.5105684399604797 train_finish_times: [7.6529381275177, 7.60658597946167, 7.406174182891846]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.5106 train time 7.4062[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.8164589405059814 hit rate: 0.9102200269699097 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.8164589405059814 hit rate: 0.9102200269699097 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.8165
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9102
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.908658504486084 hit rate: 0.9698821306228638 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.908658504486084 hit rate: 0.9698821306228638 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.820864200592041 hit rate: 0.9168594479560852 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.820864200592041 hit rate: 0.9168594479560852 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.8013228178024292 hit rate: 0.89944988489151 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.8013228178024292 hit rate: 0.89944988489151 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.6632052659988403 hit rate: 0.7904701232910156 traveled user hit rate: 0.739130437374115
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.6632052659988403 hit rate: 0.7904701232910156 traveled user hit rate: 0.739130437374115

Predict Day 20 average auc score: 0.8021019101142883 hit rate: 0.8973762392997742
global rounds: 3
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=82484, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.2475 train time 4.1466
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.6632[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7905[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7391[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2876 train time 4.6308[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.17058978974819183 train_finish_times: [4.118463516235352, 4.123972654342651, 4.139730215072632]
clientId: 4 current_loss: 0.21857279539108276 train_finish_times: [4.146564722061157, 4.370868682861328, 4.218481779098511]
clientId: 2 current_loss: 0.2734625041484833 train_finish_times: [4.661701917648315, 4.630786418914795, 4.625107049942017]
clientId: 1 current_loss: 0.27907973527908325 train_finish_times: [5.056358098983765, 5.0613274574279785, 5.027160406112671]
[36m(Trainer pid=78591, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.2791 train time 5.0272[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.4434245228767395 train_finish_times: [7.624250173568726, 7.616907119750977, 7.50089955329895]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4434 train time 7.5009[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.8189040422439575 hit rate: 0.9134137630462646 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.8189040422439575 hit rate: 0.9134137630462646 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.8189
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9134
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.8262763023376465 hit rate: 0.9203973412513733 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.8262763023376465 hit rate: 0.9203973412513733 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.91066575050354 hit rate: 0.9693657755851746 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.91066575050354 hit rate: 0.9693657755851746 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.8062823414802551 hit rate: 0.9023988842964172 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.8062823414802551 hit rate: 0.9023988842964172 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.6795204877853394 hit rate: 0.8083120584487915 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.6795204877853394 hit rate: 0.8083120584487915 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.8083297610282898 hit rate: 0.9027775526046753
global rounds: 4
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1610 train time 4.1328
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.6795[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8083[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8043[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82484, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.2072 train time 4.2445
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2512 train time 4.6492[32m [repeated 6x across cluster][0m
clientId: 3 current_loss: 0.1465100795030594 train_finish_times: [4.132802724838257, 4.137131214141846, 4.114093065261841]
clientId: 4 current_loss: 0.19105656445026398 train_finish_times: [4.244511842727661, 4.40369439125061, 4.2920143604278564]
clientId: 2 current_loss: 0.24429050087928772 train_finish_times: [4.668913125991821, 4.649210214614868, 4.660048007965088]
clientId: 1 current_loss: 0.2503790855407715 train_finish_times: [5.031632661819458, 5.053398370742798, 5.049448251724243]
[36m(Trainer pid=78591, ip=192.168.14.54)[0m client 1 local steps 2 loss 0.2504 train time 5.0494[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.4001082181930542 train_finish_times: [7.61186671257019, 7.6998419761657715, 7.384773254394531]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4001 train time 7.3848[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.912402331829071 hit rate: 0.9703123569488525 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.912402331829071 hit rate: 0.9703123569488525 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.82100510597229 hit rate: 0.915897786617279 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.82100510597229 hit rate: 0.915897786617279 traveled user hit rate: 1.0

[36m(Trainer pid=78571, ip=192.168.42.57)[0m Test AUC: 0.9124
[36m(Trainer pid=78571, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9703
[36m(Trainer pid=78571, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.8307114839553833 hit rate: 0.9215539693832397 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.8307114839553833 hit rate: 0.9215539693832397 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.8104907274246216 hit rate: 0.9050643444061279 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.8104907274246216 hit rate: 0.9050643444061279 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.6927546262741089 hit rate: 0.8206764459609985 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.6927546262741089 hit rate: 0.8206764459609985 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.8134728670120239 hit rate: 0.9067009687423706
global rounds: 5
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1412 train time 4.1239
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.6928[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8207[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8261[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2304 train time 4.7500[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.13498754799365997 train_finish_times: [4.123917579650879, 4.130309343338013, 4.144204139709473]
clientId: 4 current_loss: 0.17760126292705536 train_finish_times: [4.329102993011475, 4.409730672836304, 4.336186647415161]
clientId: 2 current_loss: 0.22226937115192413 train_finish_times: [4.685034275054932, 4.749993324279785, 4.661322355270386]
clientId: 1 current_loss: 0.22828693687915802 train_finish_times: [5.055609941482544, 5.039468050003052, 5.068274736404419]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3686 train time 7.7060[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.35522085428237915 train_finish_times: [7.421849727630615, 7.70603346824646, 7.345851898193359]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.3552 train time 7.3459[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.8228033185005188 hit rate: 0.9189732670783997 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.8228033185005188 hit rate: 0.9189732670783997 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.8228
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9190
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.9139730930328369 hit rate: 0.9703984260559082 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.9139730930328369 hit rate: 0.9703984260559082 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.8342313766479492 hit rate: 0.9223703742027283 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.8342313766479492 hit rate: 0.9223703742027283 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.8139770030975342 hit rate: 0.9054613709449768 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.8139770030975342 hit rate: 0.9054613709449768 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.7017521858215332 hit rate: 0.826207160949707 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.7017521858215332 hit rate: 0.826207160949707 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.8173473477363586 hit rate: 0.9086820483207703
global rounds: 6
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1333 train time 4.1301
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.7018[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8262[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8478[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2102 train time 4.6648[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.12875935435295105 train_finish_times: [4.13008189201355, 4.161001920700073, 4.157575845718384]
clientId: 4 current_loss: 0.16415143013000488 train_finish_times: [4.319969892501831, 4.392969846725464, 4.3032143115997314]
clientId: 2 current_loss: 0.20537878572940826 train_finish_times: [4.6541547775268555, 4.664776802062988, 4.656023025512695]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3346 train time 7.4359[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.2121921181678772 train_finish_times: [5.048954010009766, 5.038177967071533, 5.0589025020599365]
clientId: 0 current_loss: 0.32350826263427734 train_finish_times: [7.445801019668579, 7.435914754867554, 7.522138833999634]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.3235 train time 7.5221[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.8241159915924072 hit rate: 0.9180269837379456 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.8241159915924072 hit rate: 0.9180269837379456 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.8241
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9180
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.915037214756012 hit rate: 0.9710868000984192 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.915037214756012 hit rate: 0.9710868000984192 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.8370182514190674 hit rate: 0.9235950708389282 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.8370182514190674 hit rate: 0.9235950708389282 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.8166887164115906 hit rate: 0.9065955877304077 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.8166887164115906 hit rate: 0.9065955877304077 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.7095127105712891 hit rate: 0.8332003951072693 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.7095127105712891 hit rate: 0.8332003951072693 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.8204746246337891 hit rate: 0.9105010032653809
global rounds: 7
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=78571, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1257 train time 4.1444
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.7095[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8332[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8261[32m [repeated 4x across cluster][0m
[36m(Trainer pid=78427, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.1941 train time 4.6191[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.12128163874149323 train_finish_times: [4.144428491592407, 4.143804550170898, 4.1666858196258545]
clientId: 4 current_loss: 0.1547066569328308 train_finish_times: [4.300731897354126, 4.370802402496338, 4.128474235534668]
clientId: 2 current_loss: 0.18908534944057465 train_finish_times: [4.662941217422485, 4.619067907333374, 4.668118715286255]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3017 train time 7.4400[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.19664178788661957 train_finish_times: [5.10679292678833, 5.0914466381073, 5.1201982498168945]
clientId: 0 current_loss: 0.29340600967407227 train_finish_times: [7.604802131652832, 7.439968109130859, 7.323993921279907]
[36m(Trainer pid=82479, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.2934 train time 7.3240[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) auc score: 0.8252651691436768 hit rate: 0.9182635545730591 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 5f889ede3025607a356a6ad735000000) final auc score: 0.8252651691436768 hit rate: 0.9182635545730591 traveled user hit rate: 1.0

[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test AUC: 0.8253
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9183
[36m(Trainer pid=82484, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) auc score: 0.9156148433685303 hit rate: 0.9715170860290527 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, bbfaf7e2d398dfa9950abdbb35000000) final auc score: 0.9156148433685303 hit rate: 0.9715170860290527 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) auc score: 0.819304347038269 hit rate: 0.9085237979888916 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 08e4c06975bb9c121dd3b99035000000) final auc score: 0.819304347038269 hit rate: 0.9085237979888916 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) auc score: 0.8396462798118591 hit rate: 0.9256361126899719 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, f6be5191da5422db9e9666dd35000000) final auc score: 0.8396462798118591 hit rate: 0.9256361126899719 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) auc score: 0.7162680625915527 hit rate: 0.839076817035675 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, d3bd00ba3f16edad8d425bee35000000) final auc score: 0.7162680625915527 hit rate: 0.839076817035675 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.8232197761535645 hit rate: 0.912603497505188
training is not complete
//train_time: 223042.272 ms//end
//Log Max memory for Large1: 10095403008.0 //end
//Log Max memory for Large2: 14071427072.0 //end
//Log Max memory for Large3: 8571920384.0 //end
//Log Max memory for Large4: 10071658496.0 //end
//Log Max memory for Server: 18445414400.0 //end
//Log Large1 network: 1795869101.0 //end
//Log Large2 network: 3589342145.0 //end
//Log Large3 network: 1795963641.0 //end
//Log Large4 network: 1795904827.0 //end
//Log Server network: 12209167.0 //end
//Log Total Actual Train Comm Cost: 8572.85 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 0.00 MB //end
The whole process has ended
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test AUC: 0.7163[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8391[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82479, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8261[32m [repeated 4x across cluster][0m

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: FedLink, Countries: US
--------------------------------------------------------------------------------

2025-05-15 01:05:03,291	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 01:05:03,292	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 01:05:03,298	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12055.741 ms //end
//Log Large1 init network: 123244.0 //end
//Log Large2 init network: 185281.0 //end
//Log Large3 init network: 158373.0 //end
//Log Large4 init network: 123887.0 //end
//Log Server init network: 367179.0 //end
//Log Initialization Communication Cost (MB): 0.91 //end
Pretrain start time recorded.
//pretrain_time: 590.0609999999999 ms//end
[36m(Trainer pid=79936, ip=192.168.14.54)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=79936, ip=192.168.14.54)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Device: 'cpu'
[36m(Trainer pid=79936, ip=192.168.14.54)[0m [Debug] Trainer running on node IP: 192.168.14.54
[36m(Trainer pid=79936, ip=192.168.14.54)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=79936, ip=192.168.14.54)[0m   return torch.load(io.BytesIO(b))
//Log Max memory for Large1: 7489798144.0 //end
//Log Max memory for Large2: 6150004736.0 //end
//Log Max memory for Large3: 5934841856.0 //end
//Log Max memory for Large4: 6217588736.0 //end
//Log Max memory for Server: 18411790336.0 //end
//Log Large1 network: 153282435.0 //end
//Log Large2 network: 407931.0 //end
//Log Large3 network: 377098.0 //end
//Log Large4 network: 376815.0 //end
//Log Server network: 344186719.0 //end
//Log Total Actual Pretrain Comm Cost: 475.53 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m loading train_data and test_data
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.7483 train time 7.4472
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.6747 train time 7.2812
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 0 current_loss: 0.6246469616889954 train_finish_times: [7.447224855422974, 7.281205654144287, 7.341022491455078]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.6246 train time 7.3410
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.6041514873504639 hit rate: 0.7352956533432007 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.6041514873504639 hit rate: 0.7352956533432007 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6041514873504639 hit rate: 0.7352956533432007
global rounds: 1
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.6042
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7353
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.5792 train time 7.3532
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.5398 train time 7.3132
clientId: 0 current_loss: 0.508594810962677 train_finish_times: [7.353244066238403, 7.313218593597412, 7.325254440307617]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.5086 train time 7.3253
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.6600195169448853 hit rate: 0.7853116393089294 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.6600195169448853 hit rate: 0.7853116393089294 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6600195169448853 hit rate: 0.7853116393089294
global rounds: 2
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.6600
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.7853
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4821 train time 7.3754
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.4569 train time 7.4381
clientId: 0 current_loss: 0.4335625171661377 train_finish_times: [7.375408172607422, 7.438078165054321, 7.3684258460998535]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.4336 train time 7.3684
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.6808
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8053
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.7826
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.6808117628097534 hit rate: 0.8052542209625244 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.6808117628097534 hit rate: 0.8052542209625244 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.6808117628097534 hit rate: 0.8052542209625244
global rounds: 3
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.4135 train time 7.3043
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3961 train time 7.4201
clientId: 0 current_loss: 0.37910357117652893 train_finish_times: [7.304326772689819, 7.4200568199157715, 7.395041227340698]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3791 train time 7.3950
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.6945909857749939 hit rate: 0.8170868158340454 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.6945909857749939 hit rate: 0.8170868158340454 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.6945909857749939 hit rate: 0.8170868158340454
global rounds: 4
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.6946
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8171
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.3627 train time 7.3129
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3482 train time 7.3857
clientId: 0 current_loss: 0.33509427309036255 train_finish_times: [7.312879800796509, 7.3856682777404785, 7.389320373535156]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.3351 train time 7.3893
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.7043044567108154 hit rate: 0.8276430368423462 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.7043044567108154 hit rate: 0.8276430368423462 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.7043044567108154 hit rate: 0.8276430368423462
global rounds: 5
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.7043
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8276
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.3222 train time 7.3172
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.3096 train time 7.3910
clientId: 0 current_loss: 0.29840680956840515 train_finish_times: [7.317199468612671, 7.391029357910156, 7.404303312301636]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2984 train time 7.4043
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.7130096554756165 hit rate: 0.8354605436325073 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.7130096554756165 hit rate: 0.8354605436325073 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.7130096554756165 hit rate: 0.8354605436325073
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.7130
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8355
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8478
global rounds: 6
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2881 train time 7.3478
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2779 train time 7.3758
clientId: 0 current_loss: 0.26820796728134155 train_finish_times: [7.347792863845825, 7.375833988189697, 7.336460828781128]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2682 train time 7.3365
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.717906653881073 hit rate: 0.8401138186454773 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.717906653881073 hit rate: 0.8401138186454773 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.717906653881073 hit rate: 0.8401138186454773
global rounds: 7
Training in LP_train_global_round, number of clients: 1
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.7179
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8401
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 0 loss 0.2594 train time 7.3985
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 1 loss 0.2512 train time 7.4334
clientId: 0 current_loss: 0.24293826520442963 train_finish_times: [7.398540019989014, 7.433395624160767, 7.413252830505371]
[36m(Trainer pid=79936, ip=192.168.14.54)[0m client 0 local steps 2 loss 0.2429 train time 7.4133
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) auc score: 0.7222800850868225 hit rate: 0.8426132798194885 traveled user hit rate: 0.8695651888847351
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, fc3aa0957a5864dbec8b595e36000000) final auc score: 0.7222800850868225 hit rate: 0.8426132798194885 traveled user hit rate: 0.8695651888847351

Predict Day 20 average auc score: 0.7222800850868225 hit rate: 0.8426132798194885
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test AUC: 0.7223
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Hit Rate at 2: 0.8426
[36m(Trainer pid=79936, ip=192.168.14.54)[0m Test Traveled User Hit Rate at 2: 0.8696
training is not complete
//train_time: 245639.72699999998 ms//end
//Log Max memory for Large1: 11466108928.0 //end
//Log Max memory for Large2: 6150119424.0 //end
//Log Max memory for Large3: 5935128576.0 //end
//Log Max memory for Large4: 6217842688.0 //end
//Log Max memory for Server: 18510966784.0 //end
//Log Large1 network: 4525978717.0 //end
//Log Large2 network: 3789696.0 //end
//Log Large3 network: 3246398.0 //end
//Log Large4 network: 3249188.0 //end
//Log Server network: 2512257132.0 //end
//Log Total Actual Train Comm Cost: 6721.99 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 4760.96 MB //end
The whole process has ended

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: FedLink, Countries: US, BR
--------------------------------------------------------------------------------

2025-05-15 01:10:26,796	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 01:10:26,797	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 01:10:26,807	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12483.912 ms //end
//Log Large1 init network: 157850.0 //end
//Log Large2 init network: 175202.0 //end
//Log Large3 init network: 151593.0 //end
//Log Large4 init network: 151410.0 //end
//Log Server init network: 305157.0 //end
//Log Initialization Communication Cost (MB): 0.90 //end
Pretrain start time recorded.
//pretrain_time: 1142.98 ms//end
[36m(Trainer pid=81295, ip=192.168.42.57)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=81295, ip=192.168.42.57)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=81147, ip=192.168.39.156)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=81295, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=81147, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=81295, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=81295, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Device: 'cpu'
[36m(Trainer pid=81147, ip=192.168.39.156)[0m [Debug] Trainer running on node IP: 192.168.39.156
[36m(Trainer pid=81147, ip=192.168.39.156)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=81147, ip=192.168.39.156)[0m   return torch.load(io.BytesIO(b))
//Log Max memory for Large1: 6089719808.0 //end
//Log Max memory for Large2: 6069637120.0 //end
//Log Max memory for Large3: 6955896832.0 //end
//Log Max memory for Large4: 6968815616.0 //end
//Log Max memory for Server: 18480553984.0 //end
//Log Large1 network: 382806.0 //end
//Log Large2 network: 390116.0 //end
//Log Large3 network: 191418388.0 //end
//Log Large4 network: 191546103.0 //end
//Log Server network: 687474135.0 //end
//Log Total Actual Pretrain Comm Cost: 1021.59 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m loading train_data and test_data
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.7810 train time 5.1442
[36m(Trainer pid=81147, ip=192.168.39.156)[0m loading train_data and test_data
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.6660 train time 5.0011[32m [repeated 2x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 1 current_loss: 0.576838493347168 train_finish_times: [5.144192934036255, 5.001146554946899, 5.044189929962158]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 1 loss 0.7028 train time 7.4637[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.6425479650497437 train_finish_times: [7.5224480628967285, 7.463656425476074, 7.422796726226807]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.6425 train time 7.4228
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.7082275152206421 hit rate: 0.8454211354255676 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.7082275152206421 hit rate: 0.8454211354255676 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.7082
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.8454
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.6079137325286865 hit rate: 0.7419165968894958 traveled user hit rate: 0.739130437374115
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.6079137325286865 hit rate: 0.7419165968894958 traveled user hit rate: 0.739130437374115

Predict Day 20 average auc score: 0.6580706238746643 hit rate: 0.7936688661575317
global rounds: 1
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.5237 train time 5.0787
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.6079
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7419
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7391
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.4561 train time 5.0678[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.40268588066101074 train_finish_times: [5.078670263290405, 5.067796945571899, 5.022628307342529]
clientId: 0 current_loss: 0.5158714056015015 train_finish_times: [7.468454122543335, 7.462915897369385, 7.45429539680481]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.5159 train time 7.4543[32m [repeated 3x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.809227705001831 hit rate: 0.9090352654457092 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.809227705001831 hit rate: 0.9090352654457092 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8092
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9090
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.659570038318634 hit rate: 0.7865082025527954 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.659570038318634 hit rate: 0.7865082025527954 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7343988418579102 hit rate: 0.8477717638015747
global rounds: 2
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.3697 train time 5.1060
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.6596
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.7865
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.3338 train time 5.0850[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.3094485402107239 train_finish_times: [5.105982303619385, 5.0849809646606445, 5.086337089538574]
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.3094 train time 5.0863[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.45052751898765564 train_finish_times: [7.438942193984985, 7.457715272903442, 7.470016956329346]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.4505 train time 7.4700
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.8248063325881958 hit rate: 0.9171996116638184 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.8248063325881958 hit rate: 0.9171996116638184 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8248
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9172
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.6743438243865967 hit rate: 0.8026483654975891 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.6743438243865967 hit rate: 0.8026483654975891 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.7495750784873962 hit rate: 0.8599239587783813
global rounds: 3
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2981 train time 5.0857
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.6743
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8026
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2747 train time 5.0976[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.2599981725215912 train_finish_times: [5.0856709480285645, 5.097593069076538, 5.120290517807007]
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2600 train time 5.1203[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.4127742350101471 train_finish_times: [7.448645830154419, 7.4416351318359375, 7.490562677383423]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.4128 train time 7.4906
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.8310815095901489 hit rate: 0.9223023653030396 traveled user hit rate: 0.800000011920929
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.8310815095901489 hit rate: 0.9223023653030396 traveled user hit rate: 0.800000011920929

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8311
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9223
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.6848359107971191 hit rate: 0.813045084476471 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.6848359107971191 hit rate: 0.813045084476471 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.757958710193634 hit rate: 0.8676737546920776
global rounds: 4
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2613 train time 5.1390
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.6848
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8130
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.7826
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2406 train time 5.1170[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.23262479901313782 train_finish_times: [5.139047145843506, 5.116994857788086, 5.126703977584839]
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2326 train time 5.1267[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.3736621141433716 train_finish_times: [7.519899368286133, 7.518391132354736, 7.515403985977173]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3737 train time 7.5154
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.8356422185897827 hit rate: 0.9244114756584167 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.8356422185897827 hit rate: 0.9244114756584167 traveled user hit rate: 1.0

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8356
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9244
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.693374752998352 hit rate: 0.8217134475708008 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.693374752998352 hit rate: 0.8217134475708008 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7645084857940674 hit rate: 0.8730624914169312
global rounds: 5
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2292 train time 5.0818
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.6934
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8217
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8043
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.2157 train time 5.0803[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.21313710510730743 train_finish_times: [5.081791162490845, 5.080307483673096, 5.1068339347839355]
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.2131 train time 5.1068[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.3421485722064972 train_finish_times: [7.47362208366394, 7.495258808135986, 7.492058992385864]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3421 train time 7.4921
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.8392044901847839 hit rate: 0.9261804223060608 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.8392044901847839 hit rate: 0.9261804223060608 traveled user hit rate: 1.0

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8392
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9262
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.7015095949172974 hit rate: 0.8293713927268982 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.7015095949172974 hit rate: 0.8293713927268982 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.7703570127487183 hit rate: 0.8777759075164795
global rounds: 6
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.2097 train time 5.0821
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.7015
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8294
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8261
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.1977 train time 5.0785[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.19391511380672455 train_finish_times: [5.082120895385742, 5.078510284423828, 5.09263801574707]
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.1939 train time 5.0926[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.3192950487136841 train_finish_times: [7.4654107093811035, 7.492859363555908, 7.472128868103027]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.3193 train time 7.4721
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.8419965505599976 hit rate: 0.9285616874694824 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.8419965505599976 hit rate: 0.9285616874694824 traveled user hit rate: 1.0

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8420
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9286
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.7083501815795898 hit rate: 0.8355402946472168 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.7083501815795898 hit rate: 0.8355402946472168 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.7751733660697937 hit rate: 0.8820509910583496
global rounds: 7
Training in LP_train_global_round, number of clients: 2
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 0 loss 0.1968 train time 5.0598
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.7084
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8355
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8261
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 1 loss 0.1837 train time 5.1231[32m [repeated 2x across cluster][0m
clientId: 1 current_loss: 0.18035905063152313 train_finish_times: [5.05975604057312, 5.123101472854614, 5.102389574050903]
[36m(Trainer pid=81295, ip=192.168.42.57)[0m client 1 local steps 2 loss 0.1804 train time 5.1024[32m [repeated 2x across cluster][0m
clientId: 0 current_loss: 0.29488852620124817 train_finish_times: [7.399230003356934, 7.416164875030518, 7.384578704833984]
[36m(Trainer pid=81147, ip=192.168.39.156)[0m client 0 local steps 2 loss 0.2949 train time 7.3846
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) auc score: 0.8439223170280457 hit rate: 0.9286297559738159 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 32e3143c793cfff68851073c37000000) final auc score: 0.8439223170280457 hit rate: 0.9286297559738159 traveled user hit rate: 1.0

[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test AUC: 0.8439
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9286
[36m(Trainer pid=81295, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) auc score: 0.7129735946655273 hit rate: 0.8388906717300415 traveled user hit rate: 0.8260869383811951
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 7b3e608294760ba13ce9306c37000000) final auc score: 0.7129735946655273 hit rate: 0.8388906717300415 traveled user hit rate: 0.8260869383811951

Predict Day 20 average auc score: 0.7784479856491089 hit rate: 0.8837602138519287
training is not complete
//train_time: 257354.721 ms//end
//Log Max memory for Large1: 6088015872.0 //end
//Log Max memory for Large2: 6063038464.0 //end
//Log Max memory for Large3: 11728113664.0 //end
//Log Max memory for Large4: 10071523328.0 //end
//Log Max memory for Server: 18853945344.0 //end
//Log Large1 network: 3355774.0 //end
//Log Large2 network: 3887519.0 //end
//Log Large3 network: 4564745511.0 //end
//Log Large4 network: 4566435391.0 //end
//Log Server network: 5014083227.0 //end
//Log Total Actual Train Comm Cost: 13496.88 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 9521.92 MB //end
The whole process has ended
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test AUC: 0.7130
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Hit Rate at 2: 0.8389
[36m(Trainer pid=81147, ip=192.168.39.156)[0m Test Traveled User Hit Rate at 2: 0.8261

--------------------------------------------------------------------------------
Running experiment 1/1:
Method: FedLink, Countries: US, BR, ID, TR, JP
--------------------------------------------------------------------------------

2025-05-15 01:16:03,094	INFO worker.py:1429 -- Using address 192.168.45.172:6379 set in the environment variable RAY_ADDRESS
2025-05-15 01:16:03,094	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 192.168.45.172:6379...
2025-05-15 01:16:03,103	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://192.168.45.172:8265 [39m[22m
Initialization start: network data collected.
gpu not detected
[Debug] Server running on IP: 192.168.45.172
//Log init_time: 12955.643 ms //end
//Log Large1 init network: 150181.0 //end
//Log Large2 init network: 175498.0 //end
//Log Large3 init network: 158831.0 //end
//Log Large4 init network: 158711.0 //end
//Log Server init network: 371267.0 //end
//Log Initialization Communication Cost (MB): 0.97 //end
Pretrain start time recorded.
//pretrain_time: 2847.676 ms//end
[36m(Trainer pid=86697, ip=192.168.14.62)[0m checking code and file path: US,data/LPDataset
[36m(Trainer pid=86697, ip=192.168.14.62)[0m printing in getdata, path: data/LPDataset
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_US.txt
[36m(Trainer pid=82794, ip=192.168.14.54)[0m checking code and file path: BR,data/LPDataset
[36m(Trainer pid=82794, ip=192.168.14.54)[0m Loading data in data/LPDataset/data_BR.txt
[36m(Trainer pid=82794, ip=192.168.42.57)[0m checking code and file path: TR,data/LPDataset
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Loading data in data/LPDataset/data_TR.txt
[36m(Trainer pid=86710, ip=192.168.14.62)[0m checking code and file path: JP,data/LPDataset
[36m(Trainer pid=86710, ip=192.168.14.62)[0m Loading data in data/LPDataset/data_JP.txt
[36m(Trainer pid=82646, ip=192.168.39.156)[0m checking code and file path: ID,data/LPDataset
[36m(Trainer pid=82646, ip=192.168.39.156)[0m Loading data in data/LPDataset/data_ID.txt
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Device: 'cpu'
[36m(Trainer pid=82794, ip=192.168.42.57)[0m [Debug] Trainer running on node IP: 192.168.42.57
[36m(Trainer pid=82646, ip=192.168.39.156)[0m printing in getdata, path: data/LPDataset[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82794, ip=192.168.42.57)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[36m(Trainer pid=82794, ip=192.168.42.57)[0m   return torch.load(io.BytesIO(b))
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Device: 'cpu'[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m [Debug] Trainer running on node IP: 192.168.14.62[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m /usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m   return torch.load(io.BytesIO(b))[32m [repeated 4x across cluster][0m
//Log Max memory for Large1: 6921621504.0 //end
//Log Max memory for Large2: 7927214080.0 //end
//Log Max memory for Large3: 6722555904.0 //end
//Log Max memory for Large4: 6833987584.0 //end
//Log Max memory for Server: 18629918720.0 //end
//Log Large1 network: 191444898.0 //end
//Log Large2 network: 382864626.0 //end
//Log Large3 network: 191480828.0 //end
//Log Large4 network: 191482590.0 //end
//Log Server network: 1717178295.0 //end
//Log Total Actual Pretrain Comm Cost: 2550.56 MB //end
Pretrain end time recorded and duration set to gauge.
Train start: network data collected.
start training
global rounds: 0
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=82794, ip=192.168.14.54)[0m loading train_data and test_data
[36m(Trainer pid=86710, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.8084 train time 4.2331
[36m(Trainer pid=82794, ip=192.168.42.57)[0m loading train_data and test_data[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.6963 train time 4.6826[32m [repeated 7x across cluster][0m
/usr/local/lib/python3.11/site-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
clientId: 4 current_loss: 0.571424126625061 train_finish_times: [4.233107089996338, 4.08908748626709, 4.05891227722168]
clientId: 3 current_loss: 0.5541839599609375 train_finish_times: [4.305506467819214, 4.169918537139893, 4.155818462371826]
clientId: 2 current_loss: 0.5985302925109863 train_finish_times: [4.827798366546631, 4.6826136112213135, 4.703521728515625]
clientId: 1 current_loss: 0.6008968949317932 train_finish_times: [5.219420909881592, 5.0831568241119385, 5.105992555618286]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.7706 train time 7.6039[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.7228289246559143 train_finish_times: [7.4873857498168945, 7.603919744491577, 7.277694463729858]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.7228 train time 7.2777[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.7619885206222534 hit rate: 0.9014714956283569 traveled user hit rate: 0.8333333134651184
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.7619885206222534 hit rate: 0.9014714956283569 traveled user hit rate: 0.8333333134651184

[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.7620
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9015
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 0.8333
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.6893045902252197 hit rate: 0.8316777944564819 traveled user hit rate: 0.6000000238418579
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.6893045902252197 hit rate: 0.8316777944564819 traveled user hit rate: 0.6000000238418579

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.6903128027915955 hit rate: 0.8291932940483093 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.6903128027915955 hit rate: 0.8291932940483093 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.674552321434021 hit rate: 0.8135314583778381 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.674552321434021 hit rate: 0.8135314583778381 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.59104984998703 hit rate: 0.7252712249755859 traveled user hit rate: 0.6739130616188049
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.59104984998703 hit rate: 0.7252712249755859 traveled user hit rate: 0.6739130616188049

Predict Day 20 average auc score: 0.6814416646957397 hit rate: 0.8202290534973145
global rounds: 1
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=86710, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.5375 train time 4.1032
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.5910[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7253[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.6739[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.4973 train time 4.6444[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.42123258113861084 train_finish_times: [4.1031787395477295, 4.114984750747681, 4.136209726333618]
clientId: 3 current_loss: 0.4001423716545105 train_finish_times: [4.16374397277832, 4.164302587509155, 4.16468358039856]
clientId: 2 current_loss: 0.44548726081848145 train_finish_times: [4.643879175186157, 4.64444375038147, 4.661746263504028]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.5978 train time 7.4067[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.4509464502334595 train_finish_times: [5.080479621887207, 5.0812461376190186, 5.083746910095215]
clientId: 0 current_loss: 0.5699834823608398 train_finish_times: [7.663684606552124, 7.40673565864563, 7.497750282287598]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.5700 train time 7.4978[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.875764787197113 hit rate: 0.9575768113136292 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.875764787197113 hit rate: 0.9575768113136292 traveled user hit rate: 1.0

[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.8758
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9576
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.784550666809082 hit rate: 0.8946061134338379 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.784550666809082 hit rate: 0.8946061134338379 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.7888014316558838 hit rate: 0.9034562706947327 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.7888014316558838 hit rate: 0.9034562706947327 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.7675086259841919 hit rate: 0.8826631903648376 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.7675086259841919 hit rate: 0.8826631903648376 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.6439343094825745 hit rate: 0.7702350616455078 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.6439343094825745 hit rate: 0.7702350616455078 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.7721120119094849 hit rate: 0.881707489490509
global rounds: 2
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=82794, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.3748 train time 4.1715
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6439[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7702[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8043[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.3712 train time 4.6819[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.27570775151252747 train_finish_times: [4.171476364135742, 4.137757301330566, 4.160546064376831]
clientId: 4 current_loss: 0.3036711513996124 train_finish_times: [4.158903360366821, 4.154494285583496, 4.194043874740601]
clientId: 2 current_loss: 0.3392815887928009 train_finish_times: [4.6538989543914795, 4.681858777999878, 4.680410623550415]
clientId: 1 current_loss: 0.3454970121383667 train_finish_times: [5.107376337051392, 5.104726552963257, 5.085169315338135]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.5155 train time 7.6776[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.49199870228767395 train_finish_times: [7.677441358566284, 7.677587509155273, 7.335365056991577]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4920 train time 7.3354[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.9056847095489502 hit rate: 0.9687634706497192 traveled user hit rate: 1.0[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.9057
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.9056847095489502 hit rate: 0.9687634706497192 traveled user hit rate: 1.0


[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9688
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.8137766122817993 hit rate: 0.9079725742340088 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.8137766122817993 hit rate: 0.9079725742340088 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.8206157088279724 hit rate: 0.9201251864433289 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.8206157088279724 hit rate: 0.9201251864433289 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.796995997428894 hit rate: 0.8967277407646179 traveled user hit rate: 0.875
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.796995997428894 hit rate: 0.8967277407646179 traveled user hit rate: 0.875

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.6622979640960693 hit rate: 0.7847798466682434 traveled user hit rate: 0.760869562625885
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.6622979640960693 hit rate: 0.7847798466682434 traveled user hit rate: 0.760869562625885

Predict Day 20 average auc score: 0.7998741865158081 hit rate: 0.8956737518310547
global rounds: 3
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=86710, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.2848 train time 4.1301
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6623[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7848[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7609[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.3037 train time 4.6693[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.23957078158855438 train_finish_times: [4.130103826522827, 4.1684746742248535, 4.054525852203369]
clientId: 3 current_loss: 0.20112648606300354 train_finish_times: [4.133155584335327, 4.166985273361206, 4.152930021286011]
clientId: 2 current_loss: 0.28796130418777466 train_finish_times: [4.670936346054077, 4.669302701950073, 4.717095136642456]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.4865 train time 7.6430[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.2939615845680237 train_finish_times: [5.102323055267334, 5.111035346984863, 5.072965621948242]
clientId: 0 current_loss: 0.4517304301261902 train_finish_times: [7.480435848236084, 7.643016576766968, 7.384801864624023]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4517 train time 7.3848[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.8190300464630127 hit rate: 0.9118760228157043 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.8190300464630127 hit rate: 0.9118760228157043 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.9097661972045898 hit rate: 0.9693657755851746 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.9097661972045898 hit rate: 0.9693657755851746 traveled user hit rate: 1.0

[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.9098
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9694
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.8269829750061035 hit rate: 0.9201931953430176 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.8269829750061035 hit rate: 0.9201931953430176 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.80280601978302 hit rate: 0.8991663455963135 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.80280601978302 hit rate: 0.8991663455963135 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.6693433523178101 hit rate: 0.7925707101821899 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.6693433523178101 hit rate: 0.7925707101821899 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.8055857419967651 hit rate: 0.8986344337463379
global rounds: 4
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=86710, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.2279 train time 4.1003
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6693[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.7926[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8043[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2648 train time 4.6724[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.2014440894126892 train_finish_times: [4.100287437438965, 4.130764722824097, 4.06671667098999]
clientId: 3 current_loss: 0.15981663763523102 train_finish_times: [4.1442201137542725, 4.185996770858765, 4.169290781021118]
clientId: 2 current_loss: 0.25240951776504517 train_finish_times: [4.675532102584839, 4.672396659851074, 4.674457788467407]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.4577 train time 7.4430[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.2579670548439026 train_finish_times: [5.089209794998169, 5.098467588424683, 5.101044178009033]
clientId: 0 current_loss: 0.4258822202682495 train_finish_times: [7.7547876834869385, 7.443037033081055, 8.62183928489685]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4259 train time 8.6218[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.9114214777946472 hit rate: 0.9695379137992859 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.9114214777946472 hit rate: 0.9695379137992859 traveled user hit rate: 1.0

[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.9114
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9695
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.8305110931396484 hit rate: 0.923458993434906 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.8305110931396484 hit rate: 0.923458993434906 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.8211881518363953 hit rate: 0.9142417907714844 traveled user hit rate: 0.8571428656578064
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.8211881518363953 hit rate: 0.9142417907714844 traveled user hit rate: 0.8571428656578064

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.8062355518341064 hit rate: 0.9011512398719788 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.8062355518341064 hit rate: 0.9011512398719788 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.6765581369400024 hit rate: 0.8011061549186707 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.6765581369400024 hit rate: 0.8011061549186707 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.8091829419136047 hit rate: 0.9018991589546204
global rounds: 5
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=82794, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1690 train time 4.1548
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6766[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8011[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7826[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2395 train time 4.6402[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.1383354216814041 train_finish_times: [4.154836893081665, 4.15498685836792, 4.151905298233032]
clientId: 4 current_loss: 0.17966681718826294 train_finish_times: [4.179062843322754, 4.222739219665527, 4.161006689071655]
clientId: 2 current_loss: 0.23258621990680695 train_finish_times: [4.653244256973267, 4.640203237533569, 4.6711156368255615]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.4202 train time 7.4480[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.23762650787830353 train_finish_times: [5.070620775222778, 5.075638771057129, 5.051509141921997]
clientId: 0 current_loss: 0.41680026054382324 train_finish_times: [7.615720510482788, 7.448044300079346, 7.336742401123047]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.4168 train time 7.3367[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.9128410816192627 hit rate: 0.9700542092323303 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.9128410816192627 hit rate: 0.9700542092323303 traveled user hit rate: 1.0

[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.9128
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9701
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.822982668876648 hit rate: 0.9179086685180664 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.822982668876648 hit rate: 0.9179086685180664 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.8336186408996582 hit rate: 0.9262484908103943 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.8336186408996582 hit rate: 0.9262484908103943 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.8091905117034912 hit rate: 0.9019452333450317 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.8091905117034912 hit rate: 0.9019452333450317 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.683639645576477 hit rate: 0.8080195784568787 traveled user hit rate: 0.782608687877655
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.683639645576477 hit rate: 0.8080195784568787 traveled user hit rate: 0.782608687877655

Predict Day 20 average auc score: 0.8124545216560364 hit rate: 0.9048352241516113
global rounds: 6
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=82794, ip=192.168.42.57)[0m client 3 local steps 0 loss 0.1564 train time 4.1704
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6836[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8080[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.7826[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2222 train time 4.6398[32m [repeated 7x across cluster][0m
clientId: 3 current_loss: 0.1260567307472229 train_finish_times: [4.1703503131866455, 4.165832757949829, 4.182372093200684]
clientId: 4 current_loss: 0.1660211682319641 train_finish_times: [4.108182668685913, 4.435127019882202, 4.1300060749053955]
clientId: 2 current_loss: 0.21521328389644623 train_finish_times: [4.621209144592285, 4.639789819717407, 4.640055179595947]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3954 train time 7.7179[32m [repeated 5x across cluster][0m
clientId: 1 current_loss: 0.22050555050373077 train_finish_times: [5.072514772415161, 5.061903715133667, 5.0768210887908936]
clientId: 0 current_loss: 0.3922279179096222 train_finish_times: [7.414240837097168, 7.717924356460571, 7.369785785675049]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.3922 train time 7.3698[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.9139858484268188 hit rate: 0.9693657755851746 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.9139858484268188 hit rate: 0.9693657755851746 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.8244595527648926 hit rate: 0.9195647239685059 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.8244595527648926 hit rate: 0.9195647239685059 traveled user hit rate: 1.0

[36m(Trainer pid=86710, ip=192.168.14.62)[0m Test AUC: 0.8245
[36m(Trainer pid=86710, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.9196
[36m(Trainer pid=86710, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.8361873030662537 hit rate: 0.9274731278419495 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.8361873030662537 hit rate: 0.9274731278419495 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.8115140199661255 hit rate: 0.9038734436035156 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.8115140199661255 hit rate: 0.9038734436035156 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.6897794008255005 hit rate: 0.8147468566894531 traveled user hit rate: 0.804347813129425
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.6897794008255005 hit rate: 0.8147468566894531 traveled user hit rate: 0.804347813129425

Predict Day 20 average auc score: 0.8151851892471313 hit rate: 0.907004714012146
global rounds: 7
Training in LP_train_global_round, number of clients: 5
[36m(Trainer pid=86710, ip=192.168.14.62)[0m client 4 local steps 0 loss 0.1691 train time 4.1462
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6898[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8147[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8043[32m [repeated 4x across cluster][0m
[36m(Trainer pid=82646, ip=192.168.39.156)[0m client 2 local steps 1 loss 0.2081 train time 4.6516[32m [repeated 7x across cluster][0m
clientId: 4 current_loss: 0.1577317863702774 train_finish_times: [4.146223068237305, 4.1675333976745605, 4.112954616546631]
clientId: 3 current_loss: 0.11945901811122894 train_finish_times: [4.167327165603638, 4.1444091796875, 4.141680717468262]
clientId: 2 current_loss: 0.2013385146856308 train_finish_times: [4.634185552597046, 4.651646614074707, 4.666591167449951]
clientId: 1 current_loss: 0.20742374658584595 train_finish_times: [5.0700390338897705, 5.078879117965698, 5.078510999679565]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 1 loss 0.3794 train time 7.6440[32m [repeated 5x across cluster][0m
clientId: 0 current_loss: 0.36239585280418396 train_finish_times: [7.62019944190979, 7.644032001495361, 7.31321382522583]
[36m(Trainer pid=86697, ip=192.168.14.62)[0m client 0 local steps 2 loss 0.3624 train time 7.3132[32m [repeated 2x across cluster][0m
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) auc score: 0.9148340225219727 hit rate: 0.9692797660827637 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 2e91fdcf5bca06dd8a8afad938000000) final auc score: 0.9148340225219727 hit rate: 0.9692797660827637 traveled user hit rate: 1.0

[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test AUC: 0.9148
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Hit Rate at 2: 0.9693
[36m(Trainer pid=82794, ip=192.168.42.57)[0m Test Traveled User Hit Rate at 2: 1.0000
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) auc score: 0.8255677819252014 hit rate: 0.9198012948036194 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, 9232e21ef3754ed49c3b4fa838000000) final auc score: 0.8255677819252014 hit rate: 0.9198012948036194 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) auc score: 0.8383867740631104 hit rate: 0.9284256100654602 traveled user hit rate: 1.0
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c053ecc82b73d0de61d4242238000000) final auc score: 0.8383867740631104 hit rate: 0.9284256100654602 traveled user hit rate: 1.0

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) auc score: 0.8135579824447632 hit rate: 0.9050076603889465 traveled user hit rate: 0.75
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, c55dd79a69474d2ad886aea838000000) final auc score: 0.8135579824447632 hit rate: 0.9050076603889465 traveled user hit rate: 0.75

Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) auc score: 0.6955794095993042 hit rate: 0.8208360075950623 traveled user hit rate: 0.8478260636329651
Day 0 client Actor(run_LP.<locals>.setup_trainer_server.<locals>.Trainer, b8b3c51a71a75e3cd605626f38000000) final auc score: 0.6955794095993042 hit rate: 0.8208360075950623 traveled user hit rate: 0.8478260636329651

Predict Day 20 average auc score: 0.8175851702690125 hit rate: 0.9086700677871704
training is not complete
//train_time: 296702.887 ms//end
//Log Max memory for Large1: 10695663616.0 //end
//Log Max memory for Large2: 13828079616.0 //end
//Log Max memory for Large3: 9602433024.0 //end
//Log Max memory for Large4: 10361790464.0 //end
//Log Max memory for Server: 19044503552.0 //end
//Log Large1 network: 4820612560.0 //end
//Log Large2 network: 9586082108.0 //end
//Log Large3 network: 4795941093.0 //end
//Log Large4 network: 4826146331.0 //end
//Log Server network: 12529101177.0 //end
//Log Total Actual Train Comm Cost: 34864.31 MB //end
Train end time recorded and duration set to gauge.
//Log Theoretical Pretrain Comm Cost: 0.00 MB //end
//Log Theoretical Train Comm Cost: 23804.80 MB //end
The whole process has ended
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test AUC: 0.6956[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Hit Rate at 2: 0.8208[32m [repeated 4x across cluster][0m
[36m(Trainer pid=86697, ip=192.168.14.62)[0m Test Traveled User Hit Rate at 2: 0.8478[32m [repeated 4x across cluster][0m
Benchmark completed.
Traceback (most recent call last):
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/bin/ray", line 8, in <module>
    sys.exit(main())
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/scripts/scripts.py", line 2691, in main
    return cli()
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/click/core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/click/core.py", line 1082, in main
    rv = self.invoke(ctx)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/click/core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/click/core.py", line 1697, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/click/core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/click/core.py", line 788, in invoke
    return __callback(*args, **kwargs)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/dashboard/modules/job/cli_utils.py", line 54, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/autoscaler/_private/cli_logger.py", line 823, in wrapper
    return f(*args, **kwargs)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/dashboard/modules/job/cli.py", line 310, in submit
    job_status = get_or_create_event_loop().run_until_complete(
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/dashboard/modules/job/cli.py", line 99, in _tail_logs
    return _log_job_status(client, job_id)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/dashboard/modules/job/cli.py", line 78, in _log_job_status
    info = client.get_job_info(job_id)
  File "/Users/yuyang/miniconda3/envs/fedgraph-env-py310/lib/python3.10/site-packages/ray/dashboard/modules/job/sdk.py", line 355, in get_job_info
    return JobDetails(**r.json())
TypeError: 'NoneType' object is not callable
